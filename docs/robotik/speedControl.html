<!doctype html>
<html class="docs-version-current" lang="de" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.9">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Rule The Bots RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Rule The Bots Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Rule The Bots" href="/opensearch.xml">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous"><title data-react-helmet="true">Ein Integralregler für die Geschwindigkeit | Rule The Bots</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://spacehal.github.io/docs/robotik/speedControl"><meta data-react-helmet="true" name="docsearch:language" content="de"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Ein Integralregler für die Geschwindigkeit | Rule The Bots"><meta data-react-helmet="true" name="description" content="Mit einem Integralregler und Rad-Encodern wird die Geschwindigkeit des Zumo 32u4 Roboters geregelt."><meta data-react-helmet="true" property="og:description" content="Mit einem Integralregler und Rad-Encodern wird die Geschwindigkeit des Zumo 32u4 Roboters geregelt."><meta data-react-helmet="true" name="keywords" content="Arduino,Roboter,Robotik,Gesschwindigkeit regeln,Quadraturencoder,Inkrementalgeber,Radencoder,Motorencoder,Integralregler,Integral-Regler,I-Regler,Zumo 32u4"><link data-react-helmet="true" rel="shortcut icon" href="/img/LogoSmallRed.svg"><link data-react-helmet="true" rel="canonical" href="https://spacehal.github.io/docs/robotik/speedControl"><link data-react-helmet="true" rel="alternate" href="https://spacehal.github.io/docs/robotik/speedControl" hreflang="de"><link data-react-helmet="true" rel="alternate" href="https://spacehal.github.io/docs/robotik/speedControl" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.0b66cafd.css">
<link rel="preload" href="/assets/js/runtime~main.acaeece8.js" as="script">
<link rel="preload" href="/assets/js/main.191c7d17.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Zum Hauptinhalt springen</a></div><nav class="navbar navbar--fixed-top navbarHideable_2qcr"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/LogoSmallRed.svg" alt="Rule the Bots" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/img/LogoSmallRed.svg" alt="Rule the Bots" class="themedImage_1VuW themedImage--dark_hz6m"></div><b class="navbar__title">RuleTheBots</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/arduino/helloworld">Arduino</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/robotik/beginning">Robotik</a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/zumo32u4/gettingStarted">Zumo32u4</a><a class="navbar__item navbar__link" href="/docs/more/links">Links</a><div class="searchBox_1Doo"><button type="button" class="DocSearch DocSearch-Button" aria-label="Suche"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Suche</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button aria-label="Zurück nach oben scrollen" class="clean-btn theme-back-to-top-button backToTopButton_35hR" type="button"></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo sidebarWithHideableNavbar_267A"><a tabindex="-1" class="sidebarLogo_3h0W" href="/"><img src="/img/LogoSmallRed.svg" alt="Rule the Bots" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/img/LogoSmallRed.svg" alt="Rule the Bots" class="themedImage_1VuW themedImage--dark_hz6m"><b>RuleTheBots</b></a><nav class="menu thin-scrollbar menu_Bmed"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Robotik</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Linienfolger</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">Lagebestimmung</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/robotik/wheelEncoder">Motorencoder</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/robotik/goStraight">Ge­ra­de­aus­fahrt</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/robotik/speedControl">Geschwindigkeitsregler</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/robotik/botBarcode">Anwendung: Barcode</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/robotik/odometrie">Odometrie</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/robotik/gyroscope">Gyroskop</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Gitter</a></li></ul></li></ul></nav><button type="button" title="Seitenleiste einklappen" aria-label="Seitenleiste einklappen" class="button button--secondary button--outline collapseSidebarButton_1CGd"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_3E-R"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">Auf dieser Seite</button></div><div class="theme-doc-markdown markdown"><header><h1>Ein Integralregler für die Geschwindigkeit</h1></header><p>Mit den <a href="/docs/robotik/wheelEncoder">Motor-Encodern</a> kann der Roboter nicht nur <a href="/docs/robotik/goStraight">geradeaus fahren</a> oder eine <a href="/docs/robotik/wheelEncoder#aufgaben">festgelegte Distanz</a> zurücklegen, sondern es ist damit auch möglich, die Geschwindigkeit des Roboters zu regeln. Ohne Geschwindigkeitsregelung würde zum Beispiel ein fester PWM-Wert für den Motor bei abnehmender Batteriespannung zu einem langsamer fahrenden Roboter führen. </p><h2 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="vorbetrachtungen">Vorbetrachtungen<a aria-hidden="true" class="hash-link" href="#vorbetrachtungen" title="Direkter Link zur Überschrift">​</a></h2><p>Aber wie würde ein Regler für die Geschwindigkeit aussehen? Vom Linienfolger ist bereits der <a href="/docs/robotik/edge_P_Control#proportional-regler-p-controller">Proportionalregler</a> bekannt. Angenommen, der Roboter soll mit einer Geschwindigkeit von 2000 Encoder-Impulsen pro Sekunde fahren. Dann würde sich die Regelabweichung (also der Fehler) wie folgt berechnen:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly go"><pre tabindex="0" class="prism-code language-go codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">fehler </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> geschwindigkeit </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2000</span><span class="token plain">       </span><span class="token comment" style="color:#999988;font-style:italic">// Geschwindigkeit in Impulsen pro Sekunde</span><br></span></code></pre><button type="button" aria-label="In die Zwischenablage kopieren" class="copyButton_Ue-o clean-btn">Kopieren</button></div></div><p>Mit dem <a href="/docs/robotik/edge_P_Control#proportional-regler-p-controller">Proportionalregler</a> würde dann das Motorsignal für die <code>setSpeeds()</code>-Funktion bestimmt werden:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly go"><pre tabindex="0" class="prism-code language-go codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">motorSignal </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> kp </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> fehler             </span><span class="token comment" style="color:#999988;font-style:italic">// P-Regler für das Motorsignal</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">setSpeeds</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">motorSignal</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">motorSignal</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// einstellen der Geschwindigkeit</span><br></span></code></pre><button type="button" aria-label="In die Zwischenablage kopieren" class="copyButton_Ue-o clean-btn">Kopieren</button></div></div><p>Aber was würde passieren, wenn sich der Roboter mit Sollgeschwindigkeit (also 2000 Impulsen pro Sekunde) fortbewegt? Der Fehler würde null sein <code>fehler = 0</code> und dadurch würde sich auch für das Motorsignal der Wert null ergeben. Der Roboter würde also stehen bleiben. </p><p>Ein Proportional-Regler, der das Motorsignal einfach nur proportional zum Fehler bestimmt, ist also zur Regelung der Geschwindigkeit ungeeignet.</p><p>Ebenfalls ist der <a href="/docs/robotik/lineFollowerPD#differential-anteil">Differential-Regler</a> ungeeignet, da er nur auf Änderungen des Fehlers eingeht. Steht der Roboter einfach nur still, so ändert sich der Fehler nicht und es würde sich für das Motorsignal nur der Wert 0 ergeben.</p><details class="details_2Ziz alert alert--info details_1VDD ueben" data-collapsed="true"><summary>Aufgaben</summary><div><div class="collapsibleContent_3OHp"> <ol><li><p>Beschreiben Sie weitere Situationen, in denen es sinnvoll ist die Motordrehzahl zu regeln.</p></li><li><p>Lassen Sie den Roboter über eine Zeit von ca. 0,5 Sekunden mit verschiedenen Geschwindigkeiten (200, 300, 400) fahren. Bestimmen sie gleichzeitig die <strong>aktuelle Geschwindigkeit in Impulsen pro Sekunde</strong>.<br>
<!-- -->Geben Sie sowohl die Zeit als auch die Geschwindigkeit während des Beschleunigungsvorgangs auf dem seriellen Monitor aus.<br>
<!-- -->Stellen Sie abschließend ihr Ergebnisse mit einem geeignetem Programm (z.B. <a href="https://support.microsoft.com/de-de/topic/darstellen-von-daten-im-punkt-oder-liniendiagramm-4570a80f-599a-4d6b-a155-104a9018b86e#OfficeVersion=Windows" target="_blank" rel="noopener noreferrer">Excel</a> oder Openoffice) graphisch dar (y-Achse: Impulse pro Sekunde, x-Achse: Zeit in Millisekudnen) und beantworten Sie folgende Fragen:  </p><ol><li>Wie lange benötigt der Roboter, bis er seine jeweilige Maximalgeschwindigkeit erreicht hat?</li><li>Welcher Funktionstyp beschreibt den Zusammenhang zwischen Zeit und Geschwindigkeit am besten.   </li></ol><p><strong>Hinweise</strong> für die Bearbeitung</p><ul><li><p>Nutzen Sie für eine bessere Genauigkeit bei der Zeitmessung die <a href="https://www.arduino.cc/reference/de/language/functions/time/micros/" target="_blank" rel="noopener noreferrer"><code>micros()</code></a> Funktion.</p></li><li><p>Trennen sie beide Werte mit einem Tabulator (<code>\t</code>):  </p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly arduino"><pre tabindex="0" class="prism-code language-arduino codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">Serial.print(zeit), Serial.print(&quot;\t&quot;),Serial.println(geschwindigkeit);</span><br></span></code></pre><button type="button" aria-label="In die Zwischenablage kopieren" class="copyButton_Ue-o clean-btn">Kopieren</button></div></div></li><li><p>Messen Sie die Geschwindigkeit in einem Zeitintervall, welches im Mittel ca. 50 Impulse detektiert (ca. 20 ms).  </p></li><li><p>Verwenden Sie die Programmvorlage:  </p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly arduino"><pre tabindex="0" class="prism-code language-arduino codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/***************   Programmvorlage zur Geschwindigkeitsmessung   ***************</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> Zum Bestimmen der Geschwindigkeit sollten in einem festen Zeitintervall `dZeit` die</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> Encoder-Impulse der Räder bestimmt werden. Damit die Ergebnisse nicht zu stark schwanken</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> (Quantisierungsfehler), sollte das Zeitintervall in welchem die Encoder-Impulse bestimmt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> werden so festgelegt sein, das im Mittel ca. 50 Impulse detektiert werden. */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/*  ... Ihr Code ... */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">int dZeit = 20000;                                     // 20 000 Mikrosekunden</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">motors.setSpeeds(MOTOR_POWER, MOTOR_POWER);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">while (jetzt - startZeit &lt; AN_ZEIT) {                  // Messung dauert insgesamt ON_TIME</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  jetzt = micros();                                    // Nutzen Sie micros() für eine bessere Genauigkeit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if (jetzt - letztesMal &gt;= dZeit) { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    letztesMal = jetzt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    int ticksLeft = encoders.getCountsAndResetRight(); // Impulse auslesen und zurücksetzen</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    int ticksRight = encoders.getCountsAndResetLeft();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Ihr Code ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    */ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  } //if</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">} //while</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/*  ... Ihr Code ... */</span><br></span></code></pre><button type="button" aria-label="In die Zwischenablage kopieren" class="copyButton_Ue-o clean-btn">Kopieren</button></div></div></li></ul></li></ol></div></div></details><h2 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="integral-regler">Integral-Regler<a aria-hidden="true" class="hash-link" href="#integral-regler" title="Direkter Link zur Überschrift">​</a></h2><p>Die Abbildung stellt das Verhalten eines Integral-Reglers zur Geschwindigkeitsreglung dar. Die Sollgeschwindigkeit beträgt 2000 Impulse pro Sekunde.</p><div class="chartwrapper"><canvas role="img" height="60" width="100"></canvas></div><p>Ein weiterer, bisher nicht besprochener Regler ist der Integralregler. Der <strong>Integralregler</strong> (I-Regler) ändert die Stellgröße nicht proportional zum Fehler wie der Proportionalregler oder in Abhängigkeit von der Änderung des Fehlers wie der Differentialregler, sondern basierend auf der Summe (oder dem Integral) der vorhergehenden Fehler. </p><p>Mit andern Worten formuliert, der Integralanteil gibt dem Regler ein <strong>Gedächtnis der Fehler</strong>, wodurch <strong>Abweichungen</strong> von der Sollgröße, die <strong>über einen langen Zeitraum</strong> bestehen, besonders berücksichtigt werden. Im Fall</p><p>Aus mathematischer Sicht entspricht dieses Gedächtnis dem <strong>Aufsummieren der Fehler</strong> oder auch dem <a href="https://de.wikipedia.org/wiki/Regler#I-Regler_(I-Anteil)" target="_blank" rel="noopener noreferrer">Integral der Fehler</a> über die Zeit.</p><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msubsup><mo>∫</mo><mn>0</mn><mi>t</mi></msubsup><mi>e</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mtext> d</mtext><mi>t</mi><mo>≈</mo><mi>e</mi><mo stretchy="false">(</mo><msub><mi>t</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mtext> </mtext><mo>⋅</mo><mi mathvariant="normal">Δ</mi><mi>t</mi><mo>+</mo><mi>e</mi><mo stretchy="false">(</mo><msub><mi>t</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mtext> </mtext><mo>⋅</mo><mi mathvariant="normal">Δ</mi><mi>t</mi><mo>+</mo><mo>⋯</mo><mo>=</mo><mo stretchy="false">(</mo><mi>e</mi><mo stretchy="false">(</mo><msub><mi>t</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mo>+</mo><mi>e</mi><mo stretchy="false">(</mo><msub><mi>t</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>+</mo><mo>⋯</mo><mtext> </mtext><mo stretchy="false">)</mo><mtext> </mtext><mi mathvariant="normal">Δ</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">\int_{0}^{t} e(t) \text{ d}t \approx e(t_0)\ \cdot \Delta t + e(t_1)\ \cdot \Delta t + \cdots = ( e(t_0) + e(t_1) + \cdots )\ \Delta t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.455406em;vertical-align:-0.9119499999999999em"></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5434560000000002em"><span style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span><span style="top:-3.8129000000000004em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9119499999999999em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord mathnormal">e</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mord text"><span class="mord"> d</span></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">e</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace"> </span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em"></span><span class="mord">Δ</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">e</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace"> </span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em"></span><span class="mord">Δ</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord mathnormal">e</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">e</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mclose">)</span><span class="mspace"> </span><span class="mord">Δ</span><span class="mord mathnormal">t</span></span></span></span></span></div><h3 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="beispiel-geschwindigkeitsregelung">Beispiel Geschwindigkeitsregelung<a aria-hidden="true" class="hash-link" href="#beispiel-geschwindigkeitsregelung" title="Direkter Link zur Überschrift">​</a></h3><p>Für den Pseudocode kann das Integral mit Hilfe der einzelnen Summen <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo stretchy="false">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>⋅</mo><mi mathvariant="normal">Δ</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">e(t_i)\cdot \Delta t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">e</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em"></span><span class="mord">Δ</span><span class="mord mathnormal">t</span></span></span></span></span> berechnet werden. Zu jedem neuen Zeitpunkt wird zu dem bereits berechneten Integral-Wert der neue Fehler <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo stretchy="false">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>⋅</mo><mi mathvariant="normal">Δ</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">e(t_i)\cdot \Delta t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">e</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em"></span><span class="mord">Δ</span><span class="mord mathnormal">t</span></span></span></span></span> hinzuaddiert. Dadurch wird aus dem  komplizierten Integral eine sehr einfache Addition:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly go"><pre tabindex="0" class="prism-code language-go codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">integral </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> integral </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> dTime </span><span class="token comment" style="color:#999988;font-style:italic">// Aufsummieren des Fehler zum Integralanteil</span><br></span></code></pre><button type="button" aria-label="In die Zwischenablage kopieren" class="copyButton_Ue-o clean-btn">Kopieren</button></div></div><p>Der Integralanteil wird zu einer einfachen Summe, wenn bei <strong>konstanten Zeitintervallen</strong> die Multiplikation mit <code>dTime</code> weggelassen wird:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly go"><pre tabindex="0" class="prism-code language-go codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">integral </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> integral </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Aufaddieren des Fehlers liefert den Integralanteil</span><br></span></code></pre><button type="button" aria-label="In die Zwischenablage kopieren" class="copyButton_Ue-o clean-btn">Kopieren</button></div></div><p>Zur Regelung der Motorgeschwindigkeit wird der Integral-Anteil, ähnlich wie der Proportional-Anteil, mit einem Faktor <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">k_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> gewichtet. Für die Geschwindigkeitsänderung <code>deltaSpeed</code> ergibt sich dann folgender Pseudocode:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly go"><pre tabindex="0" class="prism-code language-go codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">integral    </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> integral </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token plain">     </span><span class="token comment" style="color:#999988;font-style:italic">// Aufsummieren der Fehler</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">motorSignal </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> integral </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> ki        </span><span class="token comment" style="color:#999988;font-style:italic">// I-Regler mit den Faktoren kp und ki</span><br></span></code></pre><button type="button" aria-label="In die Zwischenablage kopieren" class="copyButton_Ue-o clean-btn">Kopieren</button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="integralanteil-beschränken">Integralanteil beschränken<a aria-hidden="true" class="hash-link" href="#integralanteil-beschränken" title="Direkter Link zur Überschrift">​</a></h3><p>Wird der <strong>Integralanteil nicht unendlich groß</strong>, wenn der Fehler kontinuierlich aufaddiert wird?</p><p>Im Prinzip sollte der Integral-Anteil nicht unendlich groß werden, da der Fehler sowohl positiv, als auch negativ sein kann und sich beim Aufaddieren somit ausgleichen würde. In der Praxis sieht es jedoch oft anders aus und der <strong>Integralanteil</strong> kann <strong>unerwünscht große Werte</strong> annehmen. </p><p>Besteht für eine <em>lange Zeit</em> ein positiver Fehler (zum Beispiel durch eine enge Kurve) so ergibt sich ein recht großer Integralanteil. Wird durch den Regler der Fehler nach einer Weile wieder auf Null oder ein wenig ins Negative gebracht, wäre das Ziel erreicht, und der Roboter befände sich auf der Linie. Das Problem ist jedoch, dass der bereits stark angewachsene positive Integralanteil durch das Aufaddieren von wenigen negativen Fehlerwerten nicht schnell genug auf Null zurückgeht. </p><p>Bei der Berechnung von <code>deltaSpeed</code> würde der Integralanteil also immer noch den aufaddierten positiven Fehler korrigieren wollen, während der Roboter bereits wieder über der Linie ist. Daher macht es Sinn, <strong>für den Integral-Anteil nur eine bestimmte Anzahl von Fehlerwerten zu berücksichtigen.</strong></p><p>Wird nur der aktuelle Fehler (<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>e</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">e_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>) und der vorhergehenden Fehler (<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>e</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">e_{n-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.638891em;vertical-align:-0.208331em"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em"><span></span></span></span></span></span></span></span></span></span></span>) berücksichtigt, so würde sich folgender Pseudocode ergeben:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly txt"><pre tabindex="0" class="prism-code language-txt codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">integral = lastError + error;</span><br></span></code></pre><button type="button" aria-label="In die Zwischenablage kopieren" class="copyButton_Ue-o clean-btn">Kopieren</button></div></div><p>Sollten mehr als nur die letzte beiden Fehlerwerte berücksichtigt werden, so kann durch den Arduinobefehl <code>constrain()</code> der Wert des Integralanteils auf sinnvolle Werte begrenzt werden:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly arduino"><pre tabindex="0" class="prism-code language-arduino codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">integral = constrain(integral,-4000,4000);</span><br></span></code></pre><button type="button" aria-label="In die Zwischenablage kopieren" class="copyButton_Ue-o clean-btn">Kopieren</button></div></div><h3></h3><h2 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="pseudocode-i-regler">Pseudocode I-Regler<a aria-hidden="true" class="hash-link" href="#pseudocode-i-regler" title="Direkter Link zur Überschrift">​</a></h2><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly go"><pre tabindex="0" class="prism-code language-go codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sollSpeed </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2000</span><span class="token plain">                            </span><span class="token comment" style="color:#999988;font-style:italic">// Sollwert der Geschwindigkeit in Impulsen pro Sekunde</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ki        </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.1</span><span class="token plain">                             </span><span class="token comment" style="color:#999988;font-style:italic">// Integral-Faktor</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">integral  </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">                               </span><span class="token comment" style="color:#999988;font-style:italic">// Startwert für Integral-Anteil</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wiederhole immer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    istSpeed     </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">bestimmeSpeed</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">          </span><span class="token comment" style="color:#999988;font-style:italic">// ermitteln der aktuellen Geschwindigkeit mit den Motorencodern</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fehler       </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> sollSpeed </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> istSpeed     </span><span class="token comment" style="color:#999988;font-style:italic">// Fehlerwert, Regeldifferenz</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    integral     </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> integral </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> fehler        </span><span class="token comment" style="color:#999988;font-style:italic">// Integral-Anteil </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">begrenze</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">integral</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">                      </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                     </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    motorSignal   </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> integral </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> ki           </span><span class="token comment" style="color:#999988;font-style:italic">// PI-Regler</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                              </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">setMotors</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">motorSignal</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">motorSignal</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// Aktualisieren der Motordrehzahlen</span><br></span></code></pre><button type="button" aria-label="In die Zwischenablage kopieren" class="copyButton_Ue-o clean-btn">Kopieren</button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="pseudocode-pi-regler">Pseudocode PI-Regler<a aria-hidden="true" class="hash-link" href="#pseudocode-pi-regler" title="Direkter Link zur Überschrift">​</a></h2><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly go"><pre tabindex="0" class="prism-code language-go codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sollSpeed </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2000</span><span class="token plain">                            </span><span class="token comment" style="color:#999988;font-style:italic">// Sollwert der Geschwindigkeit in Impulsen pro Sekunde</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kp        </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">                               </span><span class="token comment" style="color:#999988;font-style:italic">// Proportional-Faktor</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ki        </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.1</span><span class="token plain">                             </span><span class="token comment" style="color:#999988;font-style:italic">// Integral-Faktor</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">integral  </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">                               </span><span class="token comment" style="color:#999988;font-style:italic">// Startwert für Integral-Anteil</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wiederhole immer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    istSpeed     </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">bestimmeSpeed</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">          </span><span class="token comment" style="color:#999988;font-style:italic">// ermitteln der aktuellen Geschwindigkeit mit den Motorencodern</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fehler        </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> sollSpeed </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> istSpeed    </span><span class="token comment" style="color:#999988;font-style:italic">// Fehlerwert, Regeldifferenz</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    integral     </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> integral </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> fehler        </span><span class="token comment" style="color:#999988;font-style:italic">// Integral-Anteil </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">begrenze</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">integral</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">                      </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                     </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    motorSignal   </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> fehler </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> kp </span><span class="token operator" style="color:#393A34">+</span><span class="token plain">  integral </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> ki   </span><span class="token comment" style="color:#999988;font-style:italic">// PI-Regler</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                              </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">setMotors</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">motorSignal</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">motorSignal</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// Aktualisieren der Motordrehzahlen</span><br></span></code></pre><button type="button" aria-label="In die Zwischenablage kopieren" class="copyButton_Ue-o clean-btn">Kopieren</button></div></div><details class="details_2Ziz alert alert--info details_1VDD ueben" data-collapsed="true"><summary>Aufgaben</summary><div><div class="collapsibleContent_3OHp"> <ol start="3"><li>Schreiben Sie einen Integral-Regler zum Regeln der Geschwindigkeit. Nehmen Sie wie in der Aufgabe 2 die aktuelle Geschwindigkeit auf und stellen Sie diese mit einem geeigneten Programm als Liniendiagramm dar.</li><li>Erweitern Sie die Geschwindigkeitsregelung aus der 3. Aufgabe um folgende Eigenschaften:<ol><li>Die Sollgeschwindigkeit soll mit den Tastern A und B eingestellt werden können.</li><li>Auf dem Display wird der aktuelle Wert für das Motorsignal (Wert für die Funktion <code>setSpeeds()</code>) angezeigt.</li><li>Der Roboter soll erkennen, wenn er gegen ein Hindernis fährt und es mit der roten LED anzeigen.</li></ol></li></ol></div></div></details></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Dokumentation Seiten Navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/robotik/goStraight"><div class="pagination-nav__sublabel">Zurück</div><div class="pagination-nav__label">« <!-- -->Ge­ra­de­aus­fahrt</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/robotik/botBarcode"><div class="pagination-nav__sublabel">Weiter</div><div class="pagination-nav__label">Anwendung: Barcode<!-- --> »</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#vorbetrachtungen" class="table-of-contents__link toc-highlight">Vorbetrachtungen</a></li><li><a href="#integral-regler" class="table-of-contents__link toc-highlight">Integral-Regler</a><ul><li><a href="#beispiel-geschwindigkeitsregelung" class="table-of-contents__link toc-highlight">Beispiel Geschwindigkeitsregelung</a></li><li><a href="#integralanteil-beschränken" class="table-of-contents__link toc-highlight">Integralanteil beschränken</a></li></ul></li><li><a href="#pseudocode-i-regler" class="table-of-contents__link toc-highlight">Pseudocode I-Regler</a></li><li><a href="#pseudocode-pi-regler" class="table-of-contents__link toc-highlight">Pseudocode PI-Regler</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/SpaceHal/spacehal.github.io/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Forum<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Schule</div><ul class="footer__items"><li class="footer__item"><a href="https://www.osztiem.de/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>OSZTIEM<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://www.arduino.cc/reference/de/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Arduino<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a class="footer__link-item" href="/docs/impressum">Impressum</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2021 Stefan Warm. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.acaeece8.js"></script>
<script src="/assets/js/main.191c7d17.js"></script>
</body>
</html>