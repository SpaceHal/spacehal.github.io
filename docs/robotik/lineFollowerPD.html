<!doctype html>
<html lang="de" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-robotik/lineFollowerPD" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">Linienfolger mit einem PD-Regler | Rule The Bots</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://spacehal.github.io/docs/robotik/lineFollowerPD"><meta data-rh="true" name="docusaurus_locale" content="de"><meta data-rh="true" name="docsearch:language" content="de"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Linienfolger mit einem PD-Regler | Rule The Bots"><meta data-rh="true" name="description" content="Programmieren eines PD-Reglers (mit proportionalem und differentialem Anteil) zum Folgen einer Linie."><meta data-rh="true" property="og:description" content="Programmieren eines PD-Reglers (mit proportionalem und differentialem Anteil) zum Folgen einer Linie."><meta data-rh="true" name="keywords" content="Arduino,Programm,Code,Linienfolger,Linienfolger Roboter,Roboter,Robotik,Pseudocode,Proportional Regler,Differential Regler,PD Regler,PID-Regler,PID-Regler Linienfolger,P-Regler,Control,Pseudocode,zumo 32u4"><link data-rh="true" rel="icon" href="/img/LogoSmallRed.svg"><link data-rh="true" rel="canonical" href="https://spacehal.github.io/docs/robotik/lineFollowerPD"><link data-rh="true" rel="alternate" href="https://spacehal.github.io/docs/robotik/lineFollowerPD" hreflang="de"><link data-rh="true" rel="alternate" href="https://spacehal.github.io/docs/robotik/lineFollowerPD" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://TBHHG3V4Z4-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Rule The Bots" href="/opensearch.xml">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.03bd3915.css">
<link rel="preload" href="/assets/js/runtime~main.f80d6ff6.js" as="script">
<link rel="preload" href="/assets/js/main.ce9931de.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Zum Hauptinhalt springen"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Zum Hauptinhalt springen</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/LogoSmallRed.svg" alt="Rule the Bots" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/LogoSmallRed.svg" alt="Rule the Bots" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">RuleTheBots</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/arduino/helloworld">Arduino</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/robotik/beginning">Robotik</a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/zumo32u4/gettingStarted">3pi+/Zumo</a><a class="navbar__item navbar__link" href="/docs/more/links">Links</a><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Suche"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Suche</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Zurück nach oben scrollen" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/"><img src="/img/LogoSmallRed.svg" alt="Rule the Bots" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/LogoSmallRed.svg" alt="Rule the Bots" class="themedImage_ToTc themedImage--dark_i4oU"><b>RuleTheBots</b></a><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/arduino">Arduino</a><button aria-label="Umschalten der Seitenleiste mit einklappbarer Kategorie &#x27;Arduino&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/robotik/beginning">Roboter</a><button aria-label="Umschalten der Seitenleiste mit einklappbarer Kategorie &#x27;Roboter&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/category/linienfolger">Linienfolger</a><button aria-label="Umschalten der Seitenleiste mit einklappbarer Kategorie &#x27;Linienfolger&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/robotik/edgeFollower">Linienfolger einfach</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/robotik/edge_P_Control">Linienfolger P-Regler</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/robotik/lineFollowerPD">Linienfolger PD-Regler</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/robotik/weightedAverage">Gewichteter Mittelwert</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/robotik/advancedLine">Linie mit Kreuzungen</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/motorencoder">Motorencoder</a><button aria-label="Umschalten der Seitenleiste mit einklappbarer Kategorie &#x27;Motorencoder&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/lokalisierung">Lokalisierung</a><button aria-label="Umschalten der Seitenleiste mit einklappbarer Kategorie &#x27;Lokalisierung&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/robotik/objektFinden">Suchen und Ausrichten</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/robotik/botBarcode">Barcode Auslesen</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/robotik/maze">Labyrinth</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/robotik/gridNavigation">Gitternavigation</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/pololu-3pizumo">Pololu 3pi+/Zumo</a><button aria-label="Umschalten der Seitenleiste mit einklappbarer Kategorie &#x27;Pololu 3pi+/Zumo&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="Seitenleiste einklappen" aria-label="Seitenleiste einklappen" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/robotik/beginning"><span itemprop="name">Roboter</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/linienfolger"><span itemprop="name">Linienfolger</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Linienfolger PD-Regler</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">Auf dieser Seite</button></div><div class="theme-doc-markdown markdown"><header><h1>Linienfolger mit einem PD-Regler</h1></header><p>Für den Kantenfolger wurde der einfache, aber dennoch effiziente <a href="/docs/robotik/edge_P_Control">P-Regler</a> zum Folgen der Kanten verwendet. Der P-Regler funktioniert mit dem richtigen Proportionalitätsfaktor <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">k_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span></span></span> in der Regel sehr zuverlässig. Trotzdem neigt er aber zu starken Oszillationsbewegungen, d.h. er wackelt an der Kante entlang, anstatt dieser ruhig zu folgen. Der sogenannte PD-Regler verbessert das Fahrverhalten des Linienfolgers besonders bei hoher Geschwindigkeit deutlich.</p><img loading="lazy" src="/img/robotik/LinienfolgerPD.webp" alt="Roboter folgen einer Linien mit PD-Regler" width="550px" class="center img_ev3q"><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="pseudocode-p-regler-linienfolger">Pseudocode P-Regler (Linienfolger)<a href="#pseudocode-p-regler-linienfolger" class="hash-link" aria-label="Direkter Link zur Pseudocode P-Regler (Linienfolger)" title="Direkter Link zur Pseudocode P-Regler (Linienfolger)">​</a></h2><p>Bevor im Folgenden schrittweise der PD-Regler eingeführt wird, wird noch einmal kurz der Pseudocode des P-Reglers für einen Linienfolger erläutert.</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Linienfolger        </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wertLinie </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">500</span><span class="token plain">                           </span><span class="token comment" style="color:#999988;font-style:italic">// Sollwert Linienkante</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kp        </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.1</span><span class="token plain">                             </span><span class="token comment" style="color:#999988;font-style:italic">// Proportional-Faktor</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wiederhole</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    wertSensor </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">messenIrSensor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">         </span><span class="token comment" style="color:#999988;font-style:italic">// Wert zwischen  0 und 1000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">error</span><span class="token plain">      </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> wertLinie </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> wertSensor   </span><span class="token comment" style="color:#999988;font-style:italic">// Fehlerwert (Regeldifferenz)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    deltaSpeed </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> kp               </span><span class="token comment" style="color:#999988;font-style:italic">// P-Regler - Ändert die Geschwindigkeit</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    leftSpeed  </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> leftSpeed </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> deltaSpeed   </span><span class="token comment" style="color:#999988;font-style:italic">// Drehzahl links bestimmen</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rightSpeed </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> rightSpeed </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> deltaSpeed  </span><span class="token comment" style="color:#999988;font-style:italic">// Drehzahl rechts bestimmen</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">begrenze</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">leftSpeed</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">                   </span><span class="token comment" style="color:#999988;font-style:italic">// Drehzahl auf sinnvolle Werte begrenzen</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">begrenze</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rightSpeed</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">                  </span><span class="token comment" style="color:#999988;font-style:italic">// (beim Zumo zwischen -400 und +400)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">setSpeeds</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">leftSpeed</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">rightSpeed</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">       </span><span class="token comment" style="color:#999988;font-style:italic">// Aktualisieren der Motordrehzahlen  </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="In die Zwischenablage kopieren" title="Kopieren" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Bei einem P-Regler hängt die Stellgröße proportional vom Fehler, also der Regelabweichung ab. Ist der Roboter weit von der Linie entfernt (große Regelabweichung), soll er stärker in Richtung Linie lenken, als wenn die Regelabweichung geringer ist. Damit der Roboter auch bei höheren Geschwindigkeiten engen Kurven gut folgen kann, muss der Proportionalitätsfaktor relativ groß gewählt werden. Dass kann jedoch dazu führen, dass der Roboter anfängt zu oszillieren, also an der Linie entlang wackelt, anstatt dieser geschmeidig zu folgen.</p><p>Mit dem Differential-Anteil eines Regler ist es mögliche diese <em>overshoots</em> oder Oszillationsbewegungen zu reduzieren, und den Roboter trotzdem sehr schnell auf Änderungen reagieren zu lassen.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="differential-anteil">Differential-Anteil<a href="#differential-anteil" class="hash-link" aria-label="Direkter Link zur Differential-Anteil" title="Direkter Link zur Differential-Anteil">​</a></h2><p>Bei einem Regler mit Proportional- und Differential-Anteil (PD-Regler genannt) werden beide Anteile entsprechend ihrer Gewichtungsfaktoren (<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mi>p</mi></msub><mo separator="true">,</mo><mtext> </mtext><msub><mi>k</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">k_p, \, k_d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>) addiert. </p><img loading="lazy" src="/img/robotik/PD-Regler.png" alt="PD-Regler" width="350px" class="center img_ev3q"><p>Wie kann nun mit dem Differential-Anteil das Oszillieren durch einen zu großen Proportional-Anteil reduziert werden? Schauen wir uns dazu den ersten Fall in der folgenden Grafik  an: <em>Fehler wird kleiner</em>. In diesem Fall fällt der Fehler (also die Abweichung des Roboters von der Linie) linear. Da der Proportional-Anteil aber zu groß ist, wird der Roboter nicht über der Linie bleiben, sondern unter anderem wegen der Trägheit über das Optimum (Linie) hinwegfahren. </p><p>Der Differentialanteil wird aus dem <a href="https://de.wikipedia.org/wiki/Steigung" target="_blank" rel="noopener noreferrer">Anstieg</a> bzw. Änderung des Fehlers bestimmt. Da der Fehler fällt, ist der <strong>Anstieg negativ</strong> und der D-Anteil liegt somit unter null. Der Stellwert, also <code>DeltaSpeed</code> wird aus der Summe vom Proportional- und Differentialanteil berechnet, weshalb der Differentialanteil in diesem Fall der Lenkbewegung zur Linie entgegenwirkt. Er <strong>reduziert also das Überschwingen</strong>.  </p><img loading="lazy" src="/img/robotik/DifferentiellerAnteil_PID.png" alt="Differentieller Anteil eines PD-Reglers" width="500px" class="center img_ev3q"><p>Nehmen wir ein anderes Beispiel. Der Roboter folgt perfekt einer Linie. Der Fehler ist sehr klein und der Regler funktioniert problemlos. Plötzlich erreicht der Roboter eine sehr scharfe Kurve. Der Fehler wäre anfangs noch moderat, würde dann aber, weil der Roboter nicht schnell genug lenkt, sehr stark ansteigen, also einen <strong>großen Anstieg</strong> aufweisen. Dieser positive Anstieg des Fehlers (<em>Fehler wird größer</em>) verursacht einen positiven Differentialanteil, was die Lenkbewegung verstärkt und hilft der Kurve besser zu folgen.</p><p>Im letzten Beispiel <em>Anstieg des Fehler ändert sich</em> ändert sie der Fehler nicht gleichmäßig, sondern der Anstieg wird mit der Zeit immer größer. In diesem Fall ändert sich auch der Differentialanteil, er wird größer und versucht der Änderung entgegenzuwirken. </p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="berechnen-des-differential-anteil">Berechnen des Differential-Anteil<a href="#berechnen-des-differential-anteil" class="hash-link" aria-label="Direkter Link zur Berechnen des Differential-Anteil" title="Direkter Link zur Berechnen des Differential-Anteil">​</a></h3><p>Mathematisch entspricht der Differential-Anteil der 1. Ableitungen des Fehlers. Alternativ, und mit dem Arduino viel einfacher zu bestimmen, kann der <a href="https://de.wikipedia.org/wiki/Differenzenquotient" target="_blank" rel="noopener noreferrer">Differenzenquotient</a> des Fehler berechnet werden. Für den Differenzenquotient gilt:</p><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>m</mi><mo>=</mo><mfrac><mrow><msub><mi>y</mi><mn>1</mn></msub><mo>−</mo><msub><mi>y</mi><mn>0</mn></msub></mrow><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>−</mo><msub><mi>x</mi><mn>0</mn></msub></mrow></mfrac><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">m = \frac{y_1-y_0}{x_1-x_0}.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.0963em;vertical-align:-0.836em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2603em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord">.</span></span></span></span></span></div><p>Wird diese Gleichung auf den Fehler <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">e</span></span></span></span></span> angewendet, ergibt sich ein einfacher Ausdrück für den Anstieg, bzw. die Änderung des Fehler <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>e</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">e&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span>, also den gesuchten Differentialanteil <code>differential</code> des Reglers:</p><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>e</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>=</mo><mfrac><mrow><msub><mi>e</mi><mtext>neu</mtext></msub><mo>−</mo><msub><mi>e</mi><mtext>alt</mtext></msub></mrow><mrow><msub><mi>t</mi><mtext>neu</mtext></msub><mo>−</mo><msub><mi>t</mi><mtext>alt</mtext></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><msub><mi>e</mi><mtext>neu</mtext></msub><mo>−</mo><msub><mi>e</mi><mtext>alt</mtext></msub></mrow><mrow><mi mathvariant="normal">Δ</mi><mi>t</mi></mrow></mfrac><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">e&#x27; = \frac{e_\text{neu}-e_\text{alt}}{t_\text{neu} - t_\text{alt}} = \frac{e_\text{neu}-e_\text{alt}}{\Delta t}.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8019em"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.0963em;vertical-align:-0.836em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2603em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">neu</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">alt</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">neu</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">alt</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.9463em;vertical-align:-0.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2603em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">Δ</span><span class="mord mathnormal">t</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">neu</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">alt</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord">.</span></span></span></span></span></div><p>Der Pseudocode für den Differential-Anteil könnte wie folgt aussehen:</p><div class="language-txt codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-txt codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">differential = (error - error_alt) / dTime</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="In die Zwischenablage kopieren" title="Kopieren" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Wenn das <strong>Zeitintervall <code>dTime</code> zwischen den Messerwerten immer gleich</strong> ist (oder zumindest sehr ähnlich), kann auf die Multiplikation mit <code>dTime</code> verzichtet werden. Dadurch ergibt sich für den D-Anteil eine einfache Subtraktion.</p><div class="language-txt codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-txt codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">differential = error - error_alt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="In die Zwischenablage kopieren" title="Kopieren" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Der Erweiterte PD-Regler ergibt sich nun aus dem mit <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">k_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span></span></span> und <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">k_d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> gewichteten P-Anteil und D-Anteil:</p><div class="language-txt codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-txt codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">differential = error - error_alt               // Differential-Anteil</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">deltaSpeed   = error * kp + differential * kd  // PD-Regler mit den Faktoren kp (proportional)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                               // und kd (differential)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="In die Zwischenablage kopieren" title="Kopieren" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="pseudocode-pd-regler">Pseudocode PD-Regler<a href="#pseudocode-pd-regler" class="hash-link" aria-label="Direkter Link zur Pseudocode PD-Regler" title="Direkter Link zur Pseudocode PD-Regler">​</a></h3><p>Für den vollständige Pseudocode des PD-Reglers (Proportional-Differential-Reglers) wird von konstanten Zeitintervallen zwischen den Messungen ausgegangen und der <code>dTime</code> Term vernachlässigt.</p><div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Kantenfolger mit einem Sensor        </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wertLinie     </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">500</span><span class="token plain">                        </span><span class="token comment" style="color:#999988;font-style:italic">// Sollwert (Sensorwert genau über der Linie)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kp            </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.2</span><span class="token plain">                        </span><span class="token comment" style="color:#999988;font-style:italic">// Proportional-Faktor</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kd            </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">                          </span><span class="token comment" style="color:#999988;font-style:italic">// Differential-Faktor</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wiederhole</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    wertSensor   </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">messenIrSensor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// Wert zwischen  0 und 4000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    error        </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> wertLinie </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> wertSensor  </span><span class="token comment" style="color:#999988;font-style:italic">// Fehlerwert, Regelabweichung</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    differential </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> error </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> error_alt       </span><span class="token comment" style="color:#999988;font-style:italic">// Differential-Anteil</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    error_alt  </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> error                     </span><span class="token comment" style="color:#999988;font-style:italic">// den letzten Fehler speichern</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                           </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    deltaSpeed </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> error </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> kp  </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> differential </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> kd  </span><span class="token comment" style="color:#999988;font-style:italic">// PD-Regler ändert die Geschwindigkeit      </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    leftSpeed  </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> leftSpeed </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> deltaSpeed    </span><span class="token comment" style="color:#999988;font-style:italic">// Drehzahl links bestimmen</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rightSpeed </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> rightSpeed </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> deltaSpeed   </span><span class="token comment" style="color:#999988;font-style:italic">// Drehzahl rechts bestimmen</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">begrenze</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">leftSpeed</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">                    </span><span class="token comment" style="color:#999988;font-style:italic">// Drehzahl auf sinnvolle Werte begrenzen</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">begrenze</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rightSpeed</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">setMotors</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">leftSpeed</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">rightSpeed</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// Aktualisieren der Motordrehzahlen</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="In die Zwischenablage kopieren" title="Kopieren" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><details class="details_lb9f alert alert--info details_b_Ee ueben" data-collapsed="true"><summary>Aufgaben</summary><div><div class="collapsibleContent_i85q"> <ol><li>Programmieren Sie einen Linienfolger mit <strong>PD-Regler</strong>. <ol><li>Implementieren Sie den PD-Regler mit einem änderbaren D-Faktor. Nutzen Sie zum Ändern des D-Faktors <code>kd</code> zwei Tasten auf dem Roboter. Der aktuelle <code>kd</code>-Wert sollte auf dem Display angezeigt werden.</li><li>Untersuchen sie zuerst den Einfluss des D-Anteils (mit konstantem P-Faktor). Ab welchem Wert beeinflusst der D-Anteil das Verhalten des Roboters. Wie verhält sich der Roboter, wenn der D-Anteil zu größ wird. Versuchen Sie das Verhalten zu erklären.</li><li>Erhöhen Sie die Motorgeschwindigkeit. Mit welcher Maximalgeschwindigkeit kann der Roboter noch der Linie folgen?</li></ol></li><li>Lassen Sie Ihre Linienfolger gegeneinander antreten. Welcher Roboter folgt der Linie am schnellsten?</li></ol></div></div></details><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="einstellen-der-parameter-kp-und-kd">Einstellen der Parameter kp und kd<a href="#einstellen-der-parameter-kp-und-kd" class="hash-link" aria-label="Direkter Link zur Einstellen der Parameter kp und kd" title="Direkter Link zur Einstellen der Parameter kp und kd">​</a></h3><p>Das Konfigurieren der Parameter für den PD-Regler erfordert Geduld und Übung. Die folgenden Hinweise sollen helfen, die Parameter für eine Strecke mit unterschiedlichen Kurvenradien anzupassen. </p><ol><li>Alle Faktoren auf Null setzen. Roboter mit geringer Geschwindigkeit fahren lassen.</li><li>Den P-Faktor erhöhen, bis der Roboter einer geraden Strecke problemlos folgen kann und Kurven mit großen Radien mit leichten Schwingungen folgt.</li><li>Erhöhen des D-Faktors, bis die Oszillationen verschwinden.</li><li>Schritte 2 und 3 wiederholen, bis eine Erhöhung des D-Faktors die Oszillation nicht mehr verschwinden lässt. (Bei zu großem D-Anteil wird der Roboter aufgrund von Rauschen anfangen zu <em>zittern</em>)</li><li>P und D-Faktoren auf den letzten stabilen Wert setzen.</li></ol><p>In der Regel sollte der Roboter nur sehr wenig oszillieren. Jedoch kann ein geringes Oszillieren auch bedeuten, dass der Roboter engen Kurven nicht immer perfekt folgen kann.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="mögliche-erweiterungen-des-pd-reglers">Mögliche Erweiterungen des PD-Reglers<a href="#mögliche-erweiterungen-des-pd-reglers" class="hash-link" aria-label="Direkter Link zur Mögliche Erweiterungen des PD-Reglers" title="Direkter Link zur Mögliche Erweiterungen des PD-Reglers">​</a></h2><ul><li>PID-Regler mit Integralanteil</li><li>Geschwindigkeit bei großen Fehlern verringern</li><li>Zeitdifferenz zwischen den Messwerten berücksichtigen</li><li>Tiefpassfilter für das Sensorsignal zum Verringern des Rauschens</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="links">Links<a href="#links" class="hash-link" aria-label="Direkter Link zur Links" title="Direkter Link zur Links">​</a></h2><ul><li><a href="http://www.olliw.eu/storm32bgc-wiki/PID_online_simulator" target="_blank" rel="noopener noreferrer">PID-Simulator</a></li><li><a href="https://m.eet.com/media/1112634/f-wescot.pdf" target="_blank" rel="noopener noreferrer">PID without a PhD</a></li><li><a href="https://www.youtube.com/watch?v=JFTJ2SS4xyA" target="_blank" rel="noopener noreferrer">PID Balance+Ball | full explanation &amp; tuning</a></li><li>Großartige Videoreihe zum PID-Regler. Es gibt kaum besser Videos zum Thema: <a href="https://www.youtube.com/watch?v=wkfEZmsQqiA&amp;list=PLn8PRpmsu08pQBgjxYFXSsODEF3Jqmm-y" target="_blank" rel="noopener noreferrer">Understanding PID Control</a></li></ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Dokumentation Seiten"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/robotik/edge_P_Control"><div class="pagination-nav__sublabel">Zurück</div><div class="pagination-nav__label">Linienfolger P-Regler</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/robotik/weightedAverage"><div class="pagination-nav__sublabel">Weiter</div><div class="pagination-nav__label">Gewichteter Mittelwert</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#pseudocode-p-regler-linienfolger" class="table-of-contents__link toc-highlight">Pseudocode P-Regler (Linienfolger)</a></li><li><a href="#differential-anteil" class="table-of-contents__link toc-highlight">Differential-Anteil</a><ul><li><a href="#berechnen-des-differential-anteil" class="table-of-contents__link toc-highlight">Berechnen des Differential-Anteil</a></li><li><a href="#pseudocode-pd-regler" class="table-of-contents__link toc-highlight">Pseudocode PD-Regler</a></li><li><a href="#einstellen-der-parameter-kp-und-kd" class="table-of-contents__link toc-highlight">Einstellen der Parameter kp und kd</a></li></ul></li><li><a href="#mögliche-erweiterungen-des-pd-reglers" class="table-of-contents__link toc-highlight">Mögliche Erweiterungen des PD-Reglers</a></li><li><a href="#links" class="table-of-contents__link toc-highlight">Links</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/SpaceHal/spacehal.github.io/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">Forum<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Schule</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.osztiem.de/" target="_blank" rel="noopener noreferrer" class="footer__link-item">OSZTIEM<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.arduino.cc/reference/de/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Arduino<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/docs/impressum">Impressum</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Stefan Warm. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.f80d6ff6.js"></script>
<script src="/assets/js/main.ce9931de.js"></script>
</body>
</html>