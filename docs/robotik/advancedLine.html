<!doctype html>
<html class="docs-version-current" lang="de" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<link rel="search" type="application/opensearchdescription+xml" title="Rule The Bots" href="/opensearch.xml">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous"><title data-react-helmet="true">Auf einer Linie mit Kreuzungen und Unterbrechungen navigieren | Rule The Bots</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://spacehal.github.io/docs/robotik/advancedLine"><meta data-react-helmet="true" name="docsearch:language" content="de"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Auf einer Linie mit Kreuzungen und Unterbrechungen navigieren | Rule The Bots"><meta data-react-helmet="true" name="description" content="Ein fortgeschrittener Linienfolger der Kreuzungen, Abzweigungen und Sackgassen erkennt und sein Verhalten automatisch anpasst."><meta data-react-helmet="true" property="og:description" content="Ein fortgeschrittener Linienfolger der Kreuzungen, Abzweigungen und Sackgassen erkennt und sein Verhalten automatisch anpasst."><meta data-react-helmet="true" name="keywords" content="Arduino,Linienfolger Kreuzungen,Kantenfolge,Roboter,Robotik,Kreuzungen,Linienunterbrechungen,Hindernis,Abbiegen,zumo 32u4"><link data-react-helmet="true" rel="icon" href="/img/LogoSmallRed.svg"><link data-react-helmet="true" rel="alternate" href="https://spacehal.github.io/docs/robotik/advancedLine" hreflang="de"><link data-react-helmet="true" rel="alternate" href="https://spacehal.github.io/docs/robotik/advancedLine" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link data-react-helmet="true" rel="canonical" href="https://spacehal.github.io/docs/robotik/advancedLine"><link rel="stylesheet" href="/assets/css/styles.d1942bf1.css">
<link rel="preload" href="/assets/js/runtime~main.866d58a0.js" as="script">
<link rel="preload" href="/assets/js/main.71b590ca.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Zum Hauptinhalt springen</a></div><nav class="navbar navbar--fixed-top navbarHideable_2qcr"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/LogoSmallRed.svg" alt="Rule the Bots" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/img/LogoSmallRed.svg" alt="Rule the Bots" class="themedImage_1VuW themedImage--dark_hz6m"></div><b class="navbar__title">RuleTheBots</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/arduino/helloworld">Arduino</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/robotik/beginning">Robotik</a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/zumo32u4/gettingStarted">Zumo32u4</a><a class="navbar__item navbar__link" href="/docs/more/links">Links</a><div class="searchBox_1Kl_"><button type="button" class="DocSearch DocSearch-Button" aria-label="Suche"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Suche</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button aria-label="Zurück nach oben scrollen" class="clean-btn theme-back-to-top-button backToTopButton_35hR" type="button"></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo sidebarWithHideableNavbar_267A"><a tabindex="-1" class="sidebarLogo_3h0W" href="/"><img src="/img/LogoSmallRed.svg" alt="Rule the Bots" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/img/LogoSmallRed.svg" alt="Rule the Bots" class="themedImage_1VuW themedImage--dark_hz6m"><b>RuleTheBots</b></a><nav class="menu thin-scrollbar menu_Bmed"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_2fq0" href="/docs/robotik/beginning">Robotik</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_2fq0" tabindex="0" href="/docs/robotik/beginning">Linienfolger</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/robotik/beginning">Erste Schritte</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/robotik/edgeFollower">Linienfolger einfach</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/robotik/edge_P_Control">Linienfolger P-Regler</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/robotik/lineFollowerPD">Linienfolger PD-Regler</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/robotik/weightedAverage">Gewichteter Mittelwert</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/robotik/advancedLine">Linie mit Kreuzungen</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" tabindex="0" href="/docs/robotik/wheelEncoder">Motorencoder</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" tabindex="0" href="/docs/robotik/odometrie">Navigation und Lokalisierung</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" tabindex="0" href="/docs/robotik/objektFinden">Hinderniserkennung</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" tabindex="0" href="/docs/robotik/gridNavigation">Gitter</a></div></li></ul></li></ul></nav><button type="button" title="Seitenleiste einklappen" aria-label="Seitenleiste einklappen" class="button button--secondary button--outline collapseSidebarButton_1CGd"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_3E-R"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">Auf dieser Seite</button></div><div class="theme-doc-markdown markdown"><header><h1>Auf einer Linie mit Kreuzungen und Unterbrechungen navigieren</h1></header><p>Das Folgen einer Linie mit Kreuzungen, Unterbrechungen oder Ähnlichem erhöht die Komplexität des Linienfolgers. </p><p>Neben dem Regler für den <a href="/docs/robotik/lineFollowerPD">Linienfolger</a> muss der Roboter zusätzlich noch so programmiert werden, dass er regelmäßig <strong>überprüft</strong>, ob er sich gerade <strong>über einer Kreuzung oder Unterbrechung befindet</strong>. Hat der Roboter ein Hindernis erkannt, muss er abhängig vom Hindernis eine vorher <strong>festgelegte Aktion</strong> (<em>links abbiegen, rechts abbiegen, weiterfahren, etc.</em>) <strong>ausführen</strong>.</p><p>Im Folgenden sind ein paar Anregungen zum Erkennen einer Kreuzung oder zum geschicketen Reagieren auf Kreuzungen aufgeführt. Es handelt sich hier nicht um eine vollständige Lösung des Problems, sondern vielmehr um mögliche Ansätze für eigene Realisierungen.</p><h2 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="auf-einer-linie-mit-kreuzungen-navigieren">Auf einer Linie mit Kreuzungen navigieren<a class="hash-link" href="#auf-einer-linie-mit-kreuzungen-navigieren" title="Direkter Link zur Überschrift">​</a></h2><img src="/img/robotik/AdvancedParcour.png" alt="Linienfolger mit Kreuzungen" width="500px" class="center"><p><em>Der vollständige <a target="_blank" href="/assets/files/AdvancedParcours-a0ac749fb43a6a84e29a243c8ec9b710.pdf">Parcours mit Kreuzungen</a> kann auch im A0 Format heruntergeladen werden.</em></p><div class="admonition admonition-caution alert alert--warning"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</h5></div><div class="admonition-content"><p>Hinweis: Die Nummerierung der Ereignisse (Kreuzungen, Wüste, Unterbrechung, etc ...) ist nur bedingt vollständig. Abhängig vom Verhalten des Roboters kann es notwendig sein, auch andere markante Stellen als Kreuzungen zu betrachten.</p></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="hauptprogramm-void-loop">Hauptprogramm <code>void loop()</code><a class="hash-link" href="#hauptprogramm-void-loop" title="Direkter Link zur Überschrift">​</a></h2><p>Um den fortgeschrittenen Linienfolger programmieren zu können, ist es wichtig ein <strong>gut strukturiertes Hauptprogramm</strong> zu haben. Steht das Hauptprogramm, kann man sich relativ gut auf die einzelnen Teilfunktionen konzentrieren, ohne die Übersicht über die verschiedenen Aufgaben zu verlieren. Im wesentlichen soll das im Hauptprogramm unterscheiden, ob der Roboter gerade der Linie folgen soll (<code>folgeLine()</code>) oder auf besondere Events (Kreuzung, Wüste, Unterbrehung) reagieren (<code>reagierenAufEvent(eventNummer)</code>) soll.</p><div class="codeBlockContainer_K1bP language-arduino theme-code-block"><div class="codeBlockContent_hGly arduino"><pre tabindex="0" class="prism-code language-arduino codeBlock_23N8 thin-scrollbar" style="background-color:#282c34;color:#ffffff"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#ffffff"><span class="token plain">/***    Hauptprogramm für den fortgeschrittenen Linienfolger   ***/</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">int eventNummer = 0;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">void loop() {</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  if (!istEvent())                       // kein Event (Kreuzung, Wüste, Unterbrechung) also Linie</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  { </span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    folgeLine();                         // Regler zum Linienfolgen</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  else                                   // Event erkannt</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  {  </span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    eventNummer++;                       // Zählvariable für die Events</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    if (eventNummer &lt; 12) {</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">      reagierenAufEvent(eventNummer);    // Abhängig vom Event abbiegen, weiterfahren, etc. </span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    else  {                              // letztes  Event ist erreicht</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">      motors.setSpeeds(0, 0);   </span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">      lcd.print(&quot; -ENDE- &quot;);</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="In die Zwischenablage kopieren" class="copyButton_Ue-o clean-btn">Kopieren</button></div></div><p>Im oben dargestellten <strong>Beispielcode</strong> wird in der ersten if-Abfrage die Funktion <a href="#funktion-istEvent"><code>istEvent()</code></a> aufgerufen. Die Funktion <code>istEvent()</code> gibt <code>true</code> zurück, sobald sich der Roboter über einer Kreuzung oder ähnlichem (Wüste, Unterbrechung) befindet. Da in der if-Abfrage die Aussage mit <code>!</code> negiert wird, folgt der Roboter so lange der Linie mit dem Befehl <code>folgeLine()</code>, wie sich der Roboter <strong>nicht</strong> auf einer Kreuzung befindet.</p><p>Wurde ein Event erkannt, wird der <code>else</code> Zweig aufgerufen und die Zählvariable <code>eventNummer</code> für die aktuelle Kreuzung um eins erhöht. Nachdem überprüft wurde, ob das letzte Event noch nicht erreicht wurde (<code>if (eventNummer &lt; 12)</code>), wird die Funktion <a href="#funktion-reagierenAufEvent"><code>reagierenAufEvent(int eventNummer)</code></a> mit der Eventnummer aufgerufen.</p><p>In der Funktion <code>reagierenAufEvent(int eventNummer)</code> sollte mit einer <code>switch</code>-<code>case</code>-Anweisung oder ähnlichem für jedes Event (<code>eventNummer</code>) eine Anweisung hinterlegt sein, wie sich der Roboter an entsprechender Stelle zu verhalten hat (<em>links abbiegen, rechts abbiegen, weiterfahren, etc.</em>).</p><h2 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="teilfunktionen">Teilfunktionen<a class="hash-link" href="#teilfunktionen" title="Direkter Link zur Überschrift">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="eventerkennung-isevent">Eventerkennung <code>isEvent()</code><a class="hash-link" href="#eventerkennung-isevent" title="Direkter Link zur Überschrift">​</a></h3><p>Wie oben beschrieben, soll die Funktion <code>istEvent()</code> nur erkennen, ob sich der Roboter über einer Kreuzung, Wüste oder Unterbrechung befindet. Hat die Funktion eine Kreuzung erkannt, soll sie den boolschen Wert <code>true</code> zurückgeben. Ansonsten ist der Rückgabewert <code>false</code>.  Dafür reicht es aus, die einzelnen Sensorwerte mit einem Schwellwert (z.B. 500) zu vergleichen und sich für die einzelnen Sensoren eine geeignete Bedingung zum Erkennen einer Kreuzung zu überlegen.</p><p>In der folgende Abbildung sind einige mögliche <em>Kreuzungstypen</em> und die zugehörigen Zustände der Bodensensoren dargestellt. Nutzen Sie diese Abbildung, um sich eine geeignete Bedingung zum Erkennen eines Events (Kreuzung, Wüste, Unterbrechung) zu überlegen. Eventuell ist es einfacher, sich eine Bedingung dafür zu überlegen, dass der Roboter sich <strong>nicht</strong> auf der Linie befindet, der gefolgt werden soll.</p><p>Verknüpfen Sie hierbei den Zustand verschiedener Sensoren mit logischen Ausdrücken (UND <code>&amp;&amp;</code>, ODER <code>||</code>) verknüpfen.</p><img src="/img/robotik/Kreuzungen.png" alt="Erkennen von Kreuzungen" width="550px" class="center"><div class="codeBlockContainer_K1bP theme-code-block"><div class="codeBlockContent_hGly arduino"><pre tabindex="0" class="prism-code language-arduino codeBlock_23N8 thin-scrollbar" style="background-color:#282c34;color:#ffffff"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#ffffff"><span class="token plain">bool istEvent(){</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  /* Gibt `true` zurück, wenn ein Event  (Kreuzungen,</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">     Wüsten oder Unterbrechungen) erkannt wurde. Verwendet</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">     die Bodensensoren zum Erkennen von Events.  */</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="In die Zwischenablage kopieren" class="copyButton_Ue-o clean-btn">Kopieren</button></div></div><details class="details_2Ziz alert alert--info details_1VDD ueben" data-collapsed="true"><summary>Aufgaben</summary><div><div class="collapsibleContent_3OHp"> <ol><li><p>Schreiben Sie ein Programm, welches den Roboter einer Linie folgen lässt und bei jeder Kreuzung (bzw. Wüste oder Unterbrechung) stehen bleibt. Nachdem ein Taster betätigt wurde, soll der Roboter wieder der Linie bis zur nächsten Kreuzung folgen (ohne abzubiegen oder ähnliches). Nutzen Sie die Vorlage.</p><div class="codeBlockContainer_K1bP theme-code-block"><div class="codeBlockContent_hGly arduino"><pre tabindex="0" class="prism-code language-arduino codeBlock_23N8 thin-scrollbar" style="background-color:#282c34;color:#ffffff"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#ffffff"><span class="token plain"> // --- Unvollständige Code-Vorlage ---</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"> void loop() {</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">   if (!istEvent()){                            // keine Kreuzung, also Linie</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">     folgeLinie();                                 // Regler zum Linienfolgen</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">   else{                                           // Kreuzung (oder ähnlich) erkannt</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">     // 1. Roboter bleibt stehen</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">     // 2. Nach Tasterdruck soll der Roboter </span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">     //    bis zur nächsten Kreuzung weiterfahren</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"> }</span><br></span></code></pre><button type="button" aria-label="In die Zwischenablage kopieren" class="copyButton_Ue-o clean-btn">Kopieren</button></div></div></li></ol></div></div></details><h3 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="auf-die-unterschiedlichen-events-reagieren-reagierenaufevent">Auf die unterschiedlichen Events reagieren <code>reagierenAufEvent()</code><a class="hash-link" href="#auf-die-unterschiedlichen-events-reagieren-reagierenaufevent" title="Direkter Link zur Überschrift">​</a></h3><div class="codeBlockContainer_K1bP theme-code-block"><div class="codeBlockContent_hGly arduino"><pre tabindex="0" class="prism-code language-arduino codeBlock_23N8 thin-scrollbar" style="background-color:#282c34;color:#ffffff"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#ffffff"><span class="token plain">void reagierenAufEvent(int pKreuzNummer) {</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  // Für jedes Event wird die zugehörige Aktion als `case` hinterlegt.</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  switch (pKreuzNummer) {</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    case 1:</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    case 2:</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    case 5:</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">      abbiegen(RECHTS);</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">      break;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    case 3:</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">      fahrenWueste();</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">      break;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">      // Weitere Anweisungen ...</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="In die Zwischenablage kopieren" class="copyButton_Ue-o clean-btn">Kopieren</button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="funktion-abbiegenint-prichtung">Funktion <code>abbiegen(int pRichtung)</code><a class="hash-link" href="#funktion-abbiegenint-prichtung" title="Direkter Link zur Überschrift">​</a></h3><p>Die Funktion <code>abbiegen(int pRichtung)</code> soll den Roboter an einer Kreuzung nach links bzw. rechts abbiegen lassen. Der Parameter <code>pRichtung</code> gibt dabei die Richtung an. Damit der Code gut lesbar ist, können mit den Zeilen</p><div class="codeBlockContainer_K1bP theme-code-block"><div class="codeBlockContent_hGly arduino"><pre tabindex="0" class="prism-code language-arduino codeBlock_23N8 thin-scrollbar" style="background-color:#282c34;color:#ffffff"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#ffffff"><span class="token plain">#define LINKS 1</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">#define RECHTS 2</span><br></span></code></pre><button type="button" aria-label="In die Zwischenablage kopieren" class="copyButton_Ue-o clean-btn">Kopieren</button></div></div><p>die Definitionen <code>LINKS</code> und <code>RECHTS</code> für die Werte <code>1</code> und <code>2</code> vorgenommen werden. Wird die Funktion dann aufgerufen, wird als Parameter nicht <code>1</code> oder <code>2</code> sondern <code>LINKS</code> und <code>RECHTS</code> übergeben. Dadurch wird die Lesbarkeit des Codes deutlich erhöht.</p><div class="codeBlockContainer_K1bP theme-code-block"><div class="codeBlockContent_hGly arduino"><pre tabindex="0" class="prism-code language-arduino codeBlock_23N8 thin-scrollbar" style="background-color:#282c34;color:#ffffff"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#ffffff"><span class="token plain">abbiegen(LINKS);  // entspricht abbiegen(1);</span><br></span></code></pre><button type="button" aria-label="In die Zwischenablage kopieren" class="copyButton_Ue-o clean-btn">Kopieren</button></div></div><p>Nachdem der Roboter mit der Funktion <code>abbiegen()</code> abgebogen ist, sollte er die zu folgende Linie erkennen und dieser auch sofort problemlos mit der Funktion <code>folgeLinie()</code> folgen können. Daher ist gut, wenn der Roboter am Ende der Funktion <code>abbiegen</code> in möglichst exakt in Fahrtrichtung auf der neuen Linie steht und gleichzeitig der Mittelsensor die Linie erkennt.</p><img src="/img/robotik/Abbiegen.png" alt="Abbiegen eines Roboters an einer Kreuzung" width="500px" class="center"><div class="codeBlockContainer_K1bP theme-code-block"><div class="codeBlockContent_hGly arduino"><pre tabindex="0" class="prism-code language-arduino codeBlock_23N8 thin-scrollbar" style="background-color:#282c34;color:#ffffff"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#ffffff"><span class="token plain">void abbiegen(int pRichtung){</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  const int drehZeit = 200; // in Millisekunden</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  const int mSpeed = 100;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  // Lässt den Roboter entsprechend des Paramters nach links</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  // oder rechts abbiegen.</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  // Nach dem Abbiegen  soll der Roboter in Fahrtrichtung</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  // mittig auf der neuen Linie stehen.</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="In die Zwischenablage kopieren" class="copyButton_Ue-o clean-btn">Kopieren</button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="hilfsfunktion-zum-debuggen">Hilfsfunktion zum Debuggen<a class="hash-link" href="#hilfsfunktion-zum-debuggen" title="Direkter Link zur Überschrift">​</a></h2><p>Die Hilfsfunktion <code>zeigeWerte()</code> gibt auf dem Display zuerst die Sensorwerte des ganz linken und ganz rechten Sensors aus. Nach zwei Sekunden wird die Anzeige geändert, und die Werte des mittleren Sensors und die Position der Linie wird ausgegeben.</p><p>Verwenden Sie die Funktion zum Testen, ob der Roboter an den Kreuzungen auch wirklich das erkennt, was sie vermuten. Nutzen Sie die, oder eine ähnliche Funktion, lieber einmal zu viel als zu wenig. Es kann Ihnen viel Mühe und Kopfzerbrechen ersparen.</p><div class="codeBlockContainer_K1bP language-arduino theme-code-block"><div class="codeBlockContent_hGly arduino"><pre tabindex="0" class="prism-code language-arduino codeBlock_23N8 thin-scrollbar" style="background-color:#282c34;color:#ffffff"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#ffffff"><span class="token plain">void zeigeWerte() {</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  char msg[8];</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  //int lPosition = lineSensors.readLine(lineSensorValues); // wenn gewollt, aktualisieren der Sensorwerte</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  sprintf(msg, &quot;0: %4d&quot;, lineSensorValues[0]);   // Sensor ganz links</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  lcd.gotoXY(0, 0); lcd.print(msg);</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  sprintf(msg, &quot;4: %4d&quot;, lineSensorValues[4]);   // Sensor ganz rechts</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  lcd.gotoXY(0, 1); lcd.print(msg);</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  delay(2000);</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  sprintf(msg, &quot;2:  %4d&quot;, lineSensorValues[2]);  // Mittelsensor </span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  lcd.gotoXY(0, 0); lcd.print(msg);</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  sprintf(msg, &quot;Pos %4d&quot;, lPosition);            // Position der Linie</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  lcd.gotoXY(0, 1); lcd.print(msg);</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  delay(2000);</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  lcd.clear();</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="In die Zwischenablage kopieren" class="copyButton_Ue-o clean-btn">Kopieren</button></div></div><p>Zum Ausgeben der Werte auf dem Display wird die Funktion <a href="/docs/arduino/seriell#ext--mit-sprintf-formatieren"><code>sprintf()</code></a> genutzt. Die Funktion erlaubt es Text und Zahlenwerte nach bestimmten Regeln zu formatieren. Der Formatierte Text wird in den <code>char</code>-Array  <code>msg[]</code> geschrieben und anschließend mit <code>lcd.print(msg1)</code> auf dem LCD-Display ausgegeben.</p><div class="admonition admonition-caution alert alert--warning"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</h5></div><div class="admonition-content"><p> Das LCD-Display des Zumo 32u4 hat pro Zeil nur 8 Zeichen. Also sollten nicht mehr als 8 Zeichen pro Zeile ausgegeben werden.</p></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"></div><div class="col lastUpdated_13-_"><span class="theme-last-updated">Letztes Update<!-- --> am <b><time datetime="2022-01-02T10:28:53.000Z">2.1.2022</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Dokumentation Seiten Navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/robotik/weightedAverage"><div class="pagination-nav__sublabel">Zurück</div><div class="pagination-nav__label">Gewichteter Mittelwert</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/robotik/wheelEncoder"><div class="pagination-nav__sublabel">Weiter</div><div class="pagination-nav__label">Motorencoder</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#auf-einer-linie-mit-kreuzungen-navigieren" class="table-of-contents__link toc-highlight">Auf einer Linie mit Kreuzungen navigieren</a></li><li><a href="#hauptprogramm-void-loop" class="table-of-contents__link toc-highlight">Hauptprogramm <code>void loop()</code></a></li><li><a href="#teilfunktionen" class="table-of-contents__link toc-highlight">Teilfunktionen</a><ul><li><a href="#eventerkennung-isevent" class="table-of-contents__link toc-highlight">Eventerkennung <code>isEvent()</code></a></li><li><a href="#auf-die-unterschiedlichen-events-reagieren-reagierenaufevent" class="table-of-contents__link toc-highlight">Auf die unterschiedlichen Events reagieren <code>reagierenAufEvent()</code></a></li><li><a href="#funktion-abbiegenint-prichtung" class="table-of-contents__link toc-highlight">Funktion <code>abbiegen(int pRichtung)</code></a></li></ul></li><li><a href="#hilfsfunktion-zum-debuggen" class="table-of-contents__link toc-highlight">Hilfsfunktion zum Debuggen</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/SpaceHal/spacehal.github.io/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Forum<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Schule</div><ul class="footer__items"><li class="footer__item"><a href="https://www.osztiem.de/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>OSZTIEM<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://www.arduino.cc/reference/de/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Arduino<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a class="footer__link-item" href="/docs/impressum">Impressum</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Stefan Warm. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.866d58a0.js"></script>
<script src="/assets/js/main.71b590ca.js"></script>
</body>
</html>