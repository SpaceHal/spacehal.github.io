<!doctype html>
<html class="docs-version-current" lang="de" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<link rel="search" type="application/opensearchdescription+xml" title="Rule The Bots" href="/opensearch.xml">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous"><title data-react-helmet="true">Entprellen eines Tasters | Rule The Bots</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://spacehal.github.io/docs/arduino/debounce"><meta data-react-helmet="true" name="docsearch:language" content="de"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Entprellen eines Tasters | Rule The Bots"><meta data-react-helmet="true" name="description" content="Wie wird ein Taster mit einem Arduino entprellt? Einfache Beispiele mit Pseudo-Code zum Entprellen mit und ohne der millis()-Funktion."><meta data-react-helmet="true" property="og:description" content="Wie wird ein Taster mit einem Arduino entprellt? Einfache Beispiele mit Pseudo-Code zum Entprellen mit und ohne der millis()-Funktion."><meta data-react-helmet="true" name="keywords" content="Arduino,Enptrellen,Taster,Pullup,Pulldown,Debouncing,millis(),Umschalten,delay(),pseudocode"><link data-react-helmet="true" rel="icon" href="/img/LogoSmallRed.svg"><link data-react-helmet="true" rel="canonical" href="https://spacehal.github.io/docs/arduino/debounce"><link data-react-helmet="true" rel="alternate" href="https://spacehal.github.io/docs/arduino/debounce" hreflang="de"><link data-react-helmet="true" rel="alternate" href="https://spacehal.github.io/docs/arduino/debounce" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.ef7832cb.css">
<link rel="preload" href="/assets/js/runtime~main.a25a652a.js" as="script">
<link rel="preload" href="/assets/js/main.25d60761.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Zum Hauptinhalt springen</a></div><nav class="navbar navbar--fixed-top navbarHideable_2qcr"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/LogoSmallRed.svg" alt="Rule the Bots" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/img/LogoSmallRed.svg" alt="Rule the Bots" class="themedImage_1VuW themedImage--dark_hz6m"></div><b class="navbar__title">RuleTheBots</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/arduino/helloworld">Arduino</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/robotik/beginning">Robotik</a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/zumo32u4/gettingStarted">Zumo32u4</a><a class="navbar__item navbar__link" href="/docs/more/links">Links</a><div class="searchBox_1Kl_"><button type="button" class="DocSearch DocSearch-Button" aria-label="Suche"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Suche</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button aria-label="Zurück nach oben scrollen" class="clean-btn theme-back-to-top-button backToTopButton_35hR" type="button"></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo sidebarWithHideableNavbar_267A"><a tabindex="-1" class="sidebarLogo_3h0W" href="/"><img src="/img/LogoSmallRed.svg" alt="Rule the Bots" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/img/LogoSmallRed.svg" alt="Rule the Bots" class="themedImage_1VuW themedImage--dark_hz6m"><b>RuleTheBots</b></a><nav class="menu thin-scrollbar menu_Bmed"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_2fq0" href="/docs/arduino/helloworld">Arduino</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_2fq0" tabindex="0" href="/docs/arduino/helloworld">Grundlagen</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/arduino/helloworld">1. Blinkende LED</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/arduino/seriell">2. Serielle Schnittstelle</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/arduino/variable">3. Variablen</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/arduino/loop">4. Schleifen</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/arduino/input">5. Taster und if-Verzweigung</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/arduino/functions">6. Funktionen</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/arduino/millis">7. Zeitkritische Aufgaben</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/arduino/debounce">8. Taster entprellen</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/arduino/array">9. Arrays (Listen)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/arduino/stateMachine">10. Endliche Automaten</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/arduino/pwm">11. PWM Signal</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/arduino/analogInput">12. Analoger Eingang</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/arduino/lightAnimation">13. Animationseffekte</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" tabindex="0" href="/docs/arduino/simpleMenu">Fortgeschritten</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" tabindex="0" href="/docs/motor/wieEsBegann">Motoren</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" tabindex="0" href="/docs/sensoren/irSensor">Sensoren</a></div></li></ul></li></ul></nav><button type="button" title="Seitenleiste einklappen" aria-label="Seitenleiste einklappen" class="button button--secondary button--outline collapseSidebarButton_1CGd"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_3E-R"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">Auf dieser Seite</button></div><div class="theme-doc-markdown markdown"><header><h1>Entprellen eines Tasters</h1></header><p>Wird ein einfacher Taster als <a href="/docs/arduino/input#ein-taster-zum-umschalten">Umschalter</a>, zum Beispiel zum An- und Ausschalten einer LED verwendet, kann es passieren, dass beim einmaligen Betätigen scheinbar zufällig manchmal geschaltet und manchmal nicht geschaltet wird. </p><p>Die Ursache für dieses scheinbar willkürliche Verhalten wird als Prellen (engl. <em>bouncing</em>) bezeichnet. Beim Drücken des Tasters ändert sich der Zustand am Eingangspin nicht nur einmal, sondern gelegentlich auch öfter. Ähnlich wie ein Lineal, welches auf einen Tisch geschlagen wird, springen die Kontakte eines Tasters beim Betätigen für einen kurzen Moment hin und her. Dies führt zu ungewollten, sich schnell ändernden Spannungszuständen am Eingangspin. Werden diese schnellen Zustandsänderungen verarbeitet, so scheint es, dass beim Betätigen des Tasters nichts passiert, obwohl in Wahrheit vielleicht angeschaltet und gleich danach wieder ausgeschaltet wurde.</p><p>Mit einem geeigneten Code können Taster entprellt werden, damit sie beim Betätigen auch wirklich nur einmal schalten. </p><h2 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="prellen-eines-tasters">Prellen eines Tasters<a class="hash-link" href="#prellen-eines-tasters" title="Direkter Link zur Überschrift">​</a></h2><img src="/img/arduino/debounce.png" alt="drawing" width="340px" class="center"><p>In der oben stehenden Abbildung ist schematisch der Verlauf der Spannung bei einem LOW-aktiven Taster (Signalpegel LOW beim Drücken) dargestellt. Wird der Taster gedrückt, so fällt die Spannung am Eingangspin zuerst auf 0 V ab, springt jedoch gleich darauf wieder auf einen höheren Spannungswert. Würde jeder Zustandswechsel von <code>HIGH</code> auf <code>LOW</code> zum Umschalten der LED führen, so wäre bei einem prellenden Schalter nicht vorhersehbar, ob die LED zum Schluss an- oder ausgeschaltet ist.</p><h2 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="entprellen-debouncing">Entprellen (debouncing)<a class="hash-link" href="#entprellen-debouncing" title="Direkter Link zur Überschrift">​</a></h2><p>Ein Taster ist entprellt, wenn die schnellen ungewollten Zustandsänderungen während des Drückens eines Tasters ignoriert wurden. Wird also am Tasterpin eine <strong>erste Zustandsänderung</strong> detektiert, müssen für eine vorgegebene Zeit (Prellzeit) alle folgenden <strong>unerwünschten Zustandsänderungen ignoriert</strong> werden. Da die meisten Taster nur in einem Zeitbereich <!-- -->\<!-- -->(\Delta t<!-- -->\<!-- -->) von ca. 30 ms prellen, sollte ein Prellzeit von 30 ms ausreichen. </p><p>Anschließend muss der <strong>Zustand des Tasters erneut eingelesen</strong> werden. Entspricht der Zustand dem nach der ersten Zustandänderung (<em>im Beispiel also LOW</em>), dann wurde der Taster erfolgreich entprellt.</p><h3 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="einfaches-blockierendes-entprellen">Einfaches (blockierendes) Entprellen<a class="hash-link" href="#einfaches-blockierendes-entprellen" title="Direkter Link zur Überschrift">​</a></h3><p>Die einfachste, wenn auch nicht beste Lösung, um einen Taster zu entprellen, kann durch eine einfache blockierende Programmverzögerung mit der <code>delay()</code>-Funktion realisiert werden.</p><p>Im folgenden Beispiel wird die <strong>fallende Flanke</strong> des Tasterpins, als der Übergang von ungedrückt <code>HIGH</code> zu gedrückt <code>LOW</code> entprellt und zum Umschalten einer LED verwendet.</p><div class="codeBlockContainer_K1bP language-arduino theme-code-block"><div style="color:#bfc7d5;background-color:#292d3e" class="codeBlockTitle_eoMF">entprellenMitDelay.ino</div><div class="codeBlockContent_hGly arduino"><pre tabindex="0" class="prism-code language-arduino codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Ein sehr einfaches Beispiel zum Entprellen eines Tasters und Umschalten einer LED.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Dieses Beispiel blockiert den MC während des Entprellens.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#define BUTTON 12                        // an Schaltung anpassen</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#define LED 3                            // an Schaltung anpassen</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">int stateButton      = HIGH;             // aktueller Status des Taster-PINs</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">int stateButtonLast  = HIGH;             // Status des Taster-PINs vor der letzten Überprüfung</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">int stateLED         = LOW;              // Status der LED (an oder aus)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">void umschaltenLED(int pPin){</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  stateLED = !stateLED;                  // LED-Status umschalten</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  digitalWrite(pPin, stateLED);          // LED-Status aktualisieren</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">void setup() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  pinMode(BUTTON, INPUT_PULLUP);         // Tasterpin mit Pull-Up-Widerstand konfigurieren</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  pinMode(LED, OUTPUT);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">void loop() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  stateButton = digitalRead(BUTTON);     // aktuellen Zustand des Tasters bestimmen</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  // Ist Taster gedrückt ( stateButton == 0 ) UND war er vorher nicht gedrückt (stateButtonLast == 1)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  if ((stateButton == 0) &amp;&amp; (stateButtonLast == 1))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    delay(30);                           // 30 ms warten, um falsche Zustandsänderungen zu ignorieren</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    stateButton = digitalRead(BUTTON);   // Zustand des Taster überprüfen</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if (stateButton == 0) {              // Ist der Taster immer noch gedrückt?</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      umschaltenLED(LED);                </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  stateButtonLast = stateButton;         // alten Wert des Tasters speichern</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="In die Zwischenablage kopieren" class="copyButton_Ue-o clean-btn">Kopieren</button></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p><strong>Hinweis:</strong> Das Zeichen <code>!</code> ist das Negationszeichen und bedeutet <em>nicht</em>. Der Ausdruck <code>stateLED = !stateLED;</code> negiert also den Wert von <code>stateLED</code> (aus 0 wird 1 und aus 1 wird 0).</p></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="pseudocode-nicht-blockierend-mit-millis">Pseudocode (nicht blockierend mit <code>millis()</code>)<a class="hash-link" href="#pseudocode-nicht-blockierend-mit-millis" title="Direkter Link zur Überschrift">​</a></h3><p>Der Nachteil des obigen Codes zum Entprellen ist, dass der Programmablauf durch die <code>delay()</code> Funktion blockiert wird. Ein nichtblockierendes Entprellen lässt sich mit der <code>millis()</code> Funktion realisieren.</p><p>Der folgende <strong>unvollständige</strong> Programmcode zum Entprellen eines Tasters mit der <code>millis()</code>-Funktion zeigt beispielhaft, wie das Drücken eines Tasters (nicht das Loslassen) entprellt werden kann.</p><div class="codeBlockContainer_K1bP language-arduino theme-code-block"><div class="codeBlockContent_hGly arduino"><pre tabindex="0" class="prism-code language-arduino codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Unvollständiger Code zum Entprellen eines Tasters und umschalten einer LED</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#define BUTTON 0                    // an Schaltung anpassen</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#define LED 13                      // an Schaltung anpassen</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">bool entprellen      = false;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">int stateButton      = HIGH;        // aktueller  Status des Tasters</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">int stateButtonLast  = HIGH;        // letzter  Status des Tasters</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">int stateLED         = LOW;         // Status der LED (an oder aus)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">unsigned long entprellZeit = 30;    // in ms</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">unsigned long zeitTaster = 0;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">void setup() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Serial.begin(115200);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  pinMode(BUTTON, INPUT_PULLUP);    // interner Pull-Up-Widerstand</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  pinMode(LED, OUTPUT);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">void loop() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  stateButton = digitalRead(BUTTON); // Taster-Pin einlesen</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  // Wurde der Taster gedrückt?</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  if ((stateButton == 0) &amp;&amp; (stateButtonLast == 1)) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // Zeitstempel zum Entprellen zurücksetzen und merken, dass</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // beim nächsten Durchlauf enprellt werden muss:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    zeitTaster = millis();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    entprellen = true;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  // Die Zustandsänderung wurde bereits erkannt, jetzt wird entprellt:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  if (entprellen)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /*                PSEUDOCODE zum Entprellen</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      --------------------------------------------------------</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      WENN (Zeit seit letzter Änderung am Pin &gt; entprellZeit)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        WENN (Taster immer noch gedrückt)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          - stateLED umschalten</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          - entprellen beenden</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      --------------------------------------------------------</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  stateButtonLast = stateButton;      // alten Tasterzustand speichern</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  digitalWrite(LED, stateLED);        // LED-Status aktualisieren</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="In die Zwischenablage kopieren" class="copyButton_Ue-o clean-btn">Kopieren</button></div></div><details class="details_2Ziz alert alert--info details_1VDD ueben" data-collapsed="true"><summary>Aufgaben</summary><div><div class="collapsibleContent_3OHp"> <ol><li><strong>Erläutern</strong> Sie, warum nach der Prellzeit der Zustand des Tasters überprüft werden muss.</li><li><strong>Vervollständigen</strong> Sie den nicht blockierenden <strong>Code zum Entprellen</strong> eines Tasters. Beim Betätigen des Tasters soll eine angeschlossene LED an- bzw. ausgeschaltet werden (toggeln).</li><li>Bauen Sie eine Schaltung mit <strong>4 gleichfarbigen LEDs und einem Taster</strong> auf. Zu Beginn leuchtet nur die erste LED. Beim ersten Betätigen des Taster soll die zweite LED aufleuchten und alle anderen LEDs aus sein. Wird der Taster ein weiteres Mal betätigt, so soll die 3. LED aufleuchten, danach die 4. LED und so weiter. Verwenden Sie einen geeigneten <strong>Automaten</strong>.</li><li>Bauen Sie eine Schaltung mit zwei LEDs und zwei Tastern auf. Schreiben Sie ein Programm, das jede LED mit einem einzelnen Taster an und ausschalten lässt (Taster 1 schaltet nur LED 1 und Taster 2 schaltet nur LED 2). Achten Sie darauf die Taster zu entprellen.</li></ol></div></div></details><h2 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="bounce2-bibliothek-zum-entprellen">Bounce2-Bibliothek zum Entprellen<a class="hash-link" href="#bounce2-bibliothek-zum-entprellen" title="Direkter Link zur Überschrift">​</a></h2><p>Mit der Arduino-Bibliothek <strong><a href="https://github.com/thomasfredericks/Bounce2" target="_blank" rel="noopener noreferrer">bounce2</a></strong> kann das Entprellen stark vereinfacht werden. Die Dokumentation findet sich <a href="http://thomasfredericks.github.io/Bounce2/files/index.html" target="_blank" rel="noopener noreferrer">hier</a>.</p><div class="codeBlockContainer_K1bP language-arduino theme-code-block"><div class="codeBlockContent_hGly arduino"><pre tabindex="0" class="prism-code language-arduino codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// This example toggles the debug LED (pin 13) on or off</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// when a button on pin 2 is pressed.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Include the Bounce2 library found here :</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// https://github.com/thomasfredericks/Bounce2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#include &lt;Bounce2.h&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#define BUTTON_PIN 2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#define LED_PIN 13</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">int ledState = LOW;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Bounce debouncer = Bounce(); // Instantiate a Bounce object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">void setup() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  debouncer.attach(BUTTON_PIN,INPUT_PULLUP); // Attach the debouncer to a pin with INPUT_PULLUP mode</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  debouncer.interval(25); // Use a debounce interval of 25 milliseconds</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  pinMode(LED_PIN,OUTPUT); // Setup the LED</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  digitalWrite(LED_PIN,ledState);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">void loop() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   debouncer.update();               // Update the Bounce instance. Should be called only once per loop().</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   if ( debouncer.fell() ) {         // Call code if button transitions from HIGH to LOW</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     ledState = !ledState;           // Toggle LED state</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     digitalWrite(LED_PIN,ledState); // Apply new LED state</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="In die Zwischenablage kopieren" class="copyButton_Ue-o clean-btn">Kopieren</button></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="links">Links<a class="hash-link" href="#links" title="Direkter Link zur Überschrift">​</a></h2><ul><li><a href="https://www.youtube.com/watch?v=e1-kc04jSE4" target="_blank" rel="noopener noreferrer">Debounce a Switch (Circuit) - Video</a></li><li><a href="http://www.skillbank.co.uk/arduino/switchbounce.htm" target="_blank" rel="noopener noreferrer">Using digital inputs: Switch bounce and solutions to it</a></li><li><a href="https://github.com/thomasfredericks/Bounce2" target="_blank" rel="noopener noreferrer">Arduino Library Bounce2</a></li><li>Die <a href="https://github.com/LennartHennigs/Button2" target="_blank" rel="noopener noreferrer">Button2-Bibliothek</a> ist deutlich umfangreicher als die Bounce2 Bibliothek und ermöglicht das Arbeit mit Eventhandlern für verschiedene Taster-Events wie <em>Click</em>, <em>LongClick</em>, <em>DoubleClick</em>, <em>TripleClick</em>.</li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"></div><div class="col lastUpdated_13-_"><span class="theme-last-updated">Letztes Update<!-- --> am <b><time datetime="2022-01-02T10:28:53.000Z">2.1.2022</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Dokumentation Seiten Navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/arduino/millis"><div class="pagination-nav__sublabel">Zurück</div><div class="pagination-nav__label">7. Zeitkritische Aufgaben</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/arduino/array"><div class="pagination-nav__sublabel">Weiter</div><div class="pagination-nav__label">9. Arrays (Listen)</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#prellen-eines-tasters" class="table-of-contents__link toc-highlight">Prellen eines Tasters</a></li><li><a href="#entprellen-debouncing" class="table-of-contents__link toc-highlight">Entprellen (debouncing)</a><ul><li><a href="#einfaches-blockierendes-entprellen" class="table-of-contents__link toc-highlight">Einfaches (blockierendes) Entprellen</a></li><li><a href="#pseudocode-nicht-blockierend-mit-millis" class="table-of-contents__link toc-highlight">Pseudocode (nicht blockierend mit <code>millis()</code>)</a></li></ul></li><li><a href="#bounce2-bibliothek-zum-entprellen" class="table-of-contents__link toc-highlight">Bounce2-Bibliothek zum Entprellen</a></li><li><a href="#links" class="table-of-contents__link toc-highlight">Links</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/SpaceHal/spacehal.github.io/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Forum<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Schule</div><ul class="footer__items"><li class="footer__item"><a href="https://www.osztiem.de/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>OSZTIEM<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://www.arduino.cc/reference/de/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Arduino<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a class="footer__link-item" href="/docs/impressum">Impressum</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Stefan Warm. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.a25a652a.js"></script>
<script src="/assets/js/main.25d60761.js"></script>
</body>
</html>