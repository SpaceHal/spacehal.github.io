<!doctype html>
<html class="docs-version-current" lang="de" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<link rel="search" type="application/opensearchdescription+xml" title="Rule The Bots" href="/opensearch.xml">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous"><title data-react-helmet="true">Endliche Automaten (Finite State Machine) | Rule The Bots</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://spacehal.github.io/docs/arduino/stateMachine"><meta data-react-helmet="true" name="docsearch:language" content="de"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Endliche Automaten (Finite State Machine) | Rule The Bots"><meta data-react-helmet="true" name="description" content="Endlichen Automaten (Zustandsdiagramme) mit dem enum Aufzählungstyp und der switch-case Anweisung im Arduino realisieren."><meta data-react-helmet="true" property="og:description" content="Endlichen Automaten (Zustandsdiagramme) mit dem enum Aufzählungstyp und der switch-case Anweisung im Arduino realisieren."><meta data-react-helmet="true" name="keywords" content="Arduino,Endlichen Automaten,Zustandsdiagramm,switch-case,Finite State Machine,State Machine"><link data-react-helmet="true" rel="icon" href="/img/LogoSmallRed.svg"><link data-react-helmet="true" rel="alternate" href="https://spacehal.github.io/docs/arduino/stateMachine" hreflang="de"><link data-react-helmet="true" rel="alternate" href="https://spacehal.github.io/docs/arduino/stateMachine" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link data-react-helmet="true" rel="canonical" href="https://spacehal.github.io/docs/arduino/stateMachine"><link rel="stylesheet" href="/assets/css/styles.8eb86931.css">
<link rel="preload" href="/assets/js/runtime~main.b4fb05fd.js" as="script">
<link rel="preload" href="/assets/js/main.42ef7b4b.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Zum Hauptinhalt springen</a></div><nav class="navbar navbar--fixed-top navbarHideable_2qcr"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/LogoSmallRed.svg" alt="Rule the Bots" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/img/LogoSmallRed.svg" alt="Rule the Bots" class="themedImage_1VuW themedImage--dark_hz6m"></div><b class="navbar__title">RuleTheBots</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/arduino/helloworld">Arduino</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/robotik/beginning">Robotik</a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/zumo32u4/gettingStarted">Zumo32u4</a><a class="navbar__item navbar__link" href="/docs/more/links">Links</a><div class="searchBox_1Kl_"><button type="button" class="DocSearch DocSearch-Button" aria-label="Suche"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Suche</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button aria-label="Zurück nach oben scrollen" class="clean-btn theme-back-to-top-button backToTopButton_35hR" type="button"></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo sidebarWithHideableNavbar_267A"><a tabindex="-1" class="sidebarLogo_3h0W" href="/"><img src="/img/LogoSmallRed.svg" alt="Rule the Bots" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/img/LogoSmallRed.svg" alt="Rule the Bots" class="themedImage_1VuW themedImage--dark_hz6m"><b>RuleTheBots</b></a><nav class="menu thin-scrollbar menu_Bmed"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_2fq0" href="/docs/arduino/helloworld">Arduino</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_2fq0" tabindex="0" href="/docs/arduino/helloworld">Grundlagen</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/arduino/helloworld">1. Blinkende LED</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/arduino/seriell">2. Serielle Schnittstelle</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/arduino/variable">3. Variablen</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/arduino/loop">4. Schleifen</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/arduino/input">5. Taster und if-Verzweigung</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/arduino/functions">6. Funktionen</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/arduino/millis">7. Zeitkritische Aufgaben</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/arduino/debounce">8. Taster entprellen</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/arduino/array">9. Arrays (Listen)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/arduino/stateMachine">10. Endliche Automaten</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/arduino/pwm">11. PWM Signal</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/arduino/analogInput">12. Analoger Eingang</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/arduino/lightAnimation">13. Animationseffekte</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" tabindex="0" href="/docs/arduino/simpleMenu">Fortgeschritten</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" tabindex="0" href="/docs/motor/wieEsBegann">Motoren</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" tabindex="0" href="/docs/sensoren/irSensor">Sensoren</a></div></li></ul></li></ul></nav><button type="button" title="Seitenleiste einklappen" aria-label="Seitenleiste einklappen" class="button button--secondary button--outline collapseSidebarButton_1CGd"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_3E-R"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">Auf dieser Seite</button></div><div class="theme-doc-markdown markdown"><header><h1>Endliche Automaten (Finite State Machine)</h1></header><p>Programme oder logische Systeme, welche eine <strong>endliche</strong> Anzahl verschiedener Zustände aufweisen und diese nach festgelegten Kriterien ändern sollen, können durch <a href="https://de.wikipedia.org/wiki/Endlicher_Automat" target="_blank" rel="noopener noreferrer">endliche Automaten</a> (auch endliche Zustandsmaschine oder <em>finit state machine - FSM</em>) modelliert werden. Ein endlicher Automat soll ein Verhalten modellieren, welches auf einer endlichen Anzahl von <strong>Zuständen</strong>, <strong>Aktionen</strong> und <strong>Zustandsübergängen</strong> basiert. </p><h2 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="wichtige-begriffe">Wichtige Begriffe<a class="hash-link" href="#wichtige-begriffe" title="Direkter Link zur Überschrift">​</a></h2><p>Im Folgenden werden die Begriffe am Beispiel der <a href="/docs/arduino/millis#blinken-mit-millis">blinkenden LED mit der millis()-Funktion</a> erläutert:</p><ul><li><strong>Zustände</strong> speichern Information bzw. einen Status ab. Im Beispiel der blinkende LED wird dafür die Variable <code>zustandLED</code> verwendet, welche angibt, ob die LED an- oder ausgeschaltet ist. Zustände alleine ändern das System jedoch nicht, dafür ist immer eine <em>Aktion</em> notwendig!</li><li>Durch eine <strong>Aktion</strong> wird der Zustand des endlichen Automaten geändert. Wann ein bestimmter Zustand geändert bzw. angenommen wird, hängt von dem System ab. Bei der blinkenden LED wird der Zustand des Automaten mit dem Befehl <code>digitalWrite(LED, zustandLED)</code> nach der Zeitabfrage geändert.</li><li><strong>Zustandsübergänge</strong> oder auch <strong>Zustandsänderungen</strong> werden in der Regel durch Programmverzweigungen wie <code>if-else</code> oder <code>switch-case</code> beschrieben. Sie geben an, unter welchen Bedingungen ein Zustand in einen anderen wechseln soll. Beim Blink-Beispiel gibt es genau zwei Zustandsänderungen: Anschalten und Ausschalten der LED. </li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="zustandsdiagramm">Zustandsdiagramm<a class="hash-link" href="#zustandsdiagramm" title="Direkter Link zur Überschrift">​</a></h2><p>Mit einem Zustandsdiagramm lassen sich endliche Automaten graphisch darstellen. Das abgebildete Zustandsdiagramm beschreibt den endlichen Automaten für die <a href="/docs/arduino/millis#blinken-mit-millis">blinkende LED</a>.</p><img src="/img/arduino/Automat.png" alt="drawing" width="460pt" class="center"><p>In einem Zustandsdiagramm wird das Verhalten eines endlichen Automaten anschaulich dargestellt. Die <strong>Zustände</strong> des Automaten werden hierbei mit Kreisen oder abgerundeten Vierecken abgebildet. Jeder Zustand darf nur einmal dargestellt werden.</p><p>Erlaubte <strong>Zustandsübergänge</strong> werden mit Pfeilen dargestellt. <strong>Aktionen</strong>, die zu Zustandsänderungen führen, müssen nicht unbedingt dargestellt werden, können aber für das Verständnis sehr hilfreich sein. Das Gleiche gilt für die Bedingungen, unter welchen der Automat seine Zustände ändert. </p><p>Im Allgemeinen gilt, so lange wie es dem Verständnis und der Übersichtlichkeit dient, sollten die Aktionen und die notwendigen Bedingungen vermerkt werden, ansonsten ist darauf zu verzichten.</p><h2 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="programmiertechniken">Programmiertechniken<a class="hash-link" href="#programmiertechniken" title="Direkter Link zur Überschrift">​</a></h2><p>Im Abschnitt <a href="/docs/arduino/millis">Zeitkritische Aufgaben</a> wurde der oben abgebildete Automat mit Hilfe der Variablen <code>int zustandLED</code> und der <code>if-else</code> Verzweigung programmiert. Bei Automaten mit mehr als nur zwei Zuständen oder bei geschachtelten Automaten gibt es jedoch einen besseren Ansatz, der das Programm übersichtlicher und lesbarer macht.</p><p>Ein etwas komplexerer Automat, welcher im Folgenden programmiert werden soll, lässt sich mit zwei LEDs erstellen. Ähnlich wie bei der blinkenden LED, wechselt der Automat nach einer vorgegeben Zeitspanne seinen Zustand. Im Zustandsdiagramm sind die vier möglichen Zustände mit den erlaubten Zustandsübergängen abgebildet.</p><img src="/img/arduino/Automat2LEDs.png" alt="drawing" width="430pt" class="center"><h3 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="enum-aufzählungstyp"><code>enum</code> Aufzählungstyp<a class="hash-link" href="#enum-aufzählungstyp" title="Direkter Link zur Überschrift">​</a></h3><p>Das Schlüsselwort <code>enum</code> ermöglicht die Aufzählung von Konstanten. Mit <code>enum</code> wird ein Aufzählungstyp deklariert:</p><div class="codeBlockContainer_K1bP language-cpp theme-code-block"><div class="codeBlockContent_hGly cpp"><pre tabindex="0" class="prism-code language-cpp codeBlock_23N8 thin-scrollbar" style="background-color:#282c34;color:#ffffff"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#ffffff"><span class="token keyword" style="color:#c5a5c5">enum</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">LedStates</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain">AUS</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> LED1</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> LED12</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> LED2</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain">  </span><span class="token comment" style="color:#999999">// Typendeklaration (Aufzählungstyp)</span><br></span></code></pre><button type="button" aria-label="In die Zwischenablage kopieren" class="copyButton_Ue-o clean-btn">Kopieren</button></div></div><p>Mit dieser Zeile wird der Aufzählungstyp  <code>LedStates</code> mit den Konstanten <code>AUS</code>, <code>LED1</code>, <code>LED12</code>, <code>LED2</code> deklariert.</p><p>Nach dieser Deklaration ist es möglich, die Variable <code>ledState</code> als <code>LedStates</code>-Typ zu deklarieren und ihr den Wert <code>AUS</code> zuzuweisen.</p><div class="codeBlockContainer_K1bP language-arduino theme-code-block"><div class="codeBlockContent_hGly arduino"><pre tabindex="0" class="prism-code language-arduino codeBlock_23N8 thin-scrollbar" style="background-color:#282c34;color:#ffffff"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#ffffff"><span class="token plain">LedStates ledState; // Variablendeklaration</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">ledState = AUS;     // Variablenzuweisung</span><br></span></code></pre><button type="button" aria-label="In die Zwischenablage kopieren" class="copyButton_Ue-o clean-btn">Kopieren</button></div></div><p>Da der <code>LedStates</code> vorher als Aufzählungstyp deklariert wurde, kann der Variablen <code>ledState</code> nur einer der vorher deklarierten Werte zugewiesen werden. Hier wird der Variablen <code>ledState</code> der Wert <code>AUS</code> zugewiesen.</p><p>Wie bei einfachen Variablen kann die Deklaration und die Zuweisung auch in einer Zeile durchgeführt werden.</p><div class="codeBlockContainer_K1bP language-arduino theme-code-block"><div class="codeBlockContent_hGly arduino"><pre tabindex="0" class="prism-code language-arduino codeBlock_23N8 thin-scrollbar" style="background-color:#282c34;color:#ffffff"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#ffffff"><span class="token plain">LedStates ledState  = AUS; // Variablendeklaration und Zuweisung</span><br></span></code></pre><button type="button" aria-label="In die Zwischenablage kopieren" class="copyButton_Ue-o clean-btn">Kopieren</button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="switch-case-verzweigung"><code>switch-case</code> Verzweigung<a class="hash-link" href="#switch-case-verzweigung" title="Direkter Link zur Überschrift">​</a></h3><p>Ähnlich wie bei der <code>if</code> Verzweigung, ermöglicht es die <a href="https://www.arduino.cc/reference/de/language/structure/control-structure/switchcase/" target="_blank" rel="noopener noreferrer"><code>switch-case</code> Verzweigung</a>, den Programmablauf in Abhängigkeit von verschiedene Bedingungen zu kontrollieren. Besonders geeignet ist die  <code>switch-case</code> Verzweigung für den Fall, dass viele verschiedene Bedingungen abgefragt werden sollen.</p><p>Als einfaches Beispiel wird die Variable <code>a</code> ausgewertet. Für den Fall, dass <code>a</code> die Werte <code>1</code>, <code>2</code> oder <code>3</code> annimmt, soll das Programm spezielle Anweisungen ausführen. Für alle anderen Werte von <code>a</code> wird der so genannte Default-Fall ausgeführt.</p><div class="codeBlockContainer_K1bP language-arduino theme-code-block"><div class="codeBlockContent_hGly arduino"><pre tabindex="0" class="prism-code language-arduino codeBlock_23N8 thin-scrollbar" style="background-color:#282c34;color:#ffffff"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#ffffff"><span class="token plain">int a = 2;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">switch (a)                      // Nach dem Schlüsselwort folgt in Klammern der auszuwertende Ausdruck</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">{</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  case 1:                       // Vergleicht `a` mit dem Wert nach case (hier 1).</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    Serial.println(&quot;Fall 1.&quot;);        </span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    break;                      // Beendet die gesamte Switch-Verzweigung. </span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  case 2:</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">     Serial.println(&quot;Fall 2.&quot;);  // Da a=2 ist, würde der hier stehen Code ausgeführt werden ...</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    break;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  case 3:</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    Serial.println(&quot;Fall 3.&quot;);</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    break;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  default:                       // Wenn `a` keinem der aufgeführten Werte entspricht</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    Serial.println(&quot;Alle anderen Zustände.&quot;);</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="In die Zwischenablage kopieren" class="copyButton_Ue-o clean-btn">Kopieren</button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="arduino-programmbeispiel">Arduino-Programmbeispiel<a class="hash-link" href="#arduino-programmbeispiel" title="Direkter Link zur Überschrift">​</a></h3><p>Die <code>switch-case</code> Verzweigung eignet sich zusammen mit der <code>enum</code> Aufzählung besonders gut zur Programmierung eines Automaten. Am Beispiel des Automaten mit 2 LEDs soll das Grundprinzip erläutert werden.</p><div class="codeBlockContainer_K1bP language-arduino theme-code-block"><div class="codeBlockContent_hGly arduino"><pre tabindex="0" class="prism-code language-arduino codeBlock_23N8 thin-scrollbar" style="background-color:#282c34;color:#ffffff"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#ffffff"><span class="token plain">#define pinLed1 6  // LED_1</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">#define pinLed2 5  // LED_2</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">// Zustände des Automaten als Aufzählungstyp deklarieren</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">enum LedStates {AUS, LED_1, LED_12, LED_2};</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">LedStates ledState = AUS;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">unsigned long letzteZeit = 0;  //  Zeitpunkt letzte LED-Änderung</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">const    long intervall  = 500;    // Blinkintervall in ms (Konstante)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">void setup() {</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  pinMode(pinLed1, OUTPUT);</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  pinMode(pinLed2, OUTPUT);</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">} </span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">void loop() {</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  // Bedingung für den Zustandsübergang. Der Automat soll seinen Zustand nur ändern,</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  // wenn die angegebene Intervall-Zeit überschritten ist.</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  if (millis() - letzteZeit &gt;= intervall)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    letzteZeit = millis();  // Zeitstempel für Zeitvergleich</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    // Jeder `case` der switch-Verzweigung entspricht dem *alten* Zustand des Automaten</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    // und gibt an, in welchen neuen Zustand gewechselt werden soll. In der case-Anweisung</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    // wird der neue Zustand des Automaten aktualisiert. Der neue Zustand wird sofort</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    // aktiviert, die entsprechenden LEDs werden an oder ausgeschaltet.</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    switch (ledState)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">      case AUS:                      // aktueller Zustand: AUS</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        ledState = LED_1;            // neuer Zustand des Automaten: LED_1</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        digitalWrite(pinLed1, HIGH); // LED_1 AN</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        digitalWrite(pinLed2, LOW);  // LED_2 AUS</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        break;                       // ohne die break-Anweisung würde sofort &#x27;case LED_2&#x27; ausgeführt werden</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">      case LED_1:                    // aktueller Zustand: LED 1 an</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        ledState = LED_12;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        digitalWrite(pinLed1, HIGH);</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        digitalWrite(pinLed2, HIGH);</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        break;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">      case LED_12:                   // aktueller Zustand: LED 1&amp;2 an</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        ledState = LED_2;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        digitalWrite(pinLed1, LOW);</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        digitalWrite(pinLed2, HIGH);</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        break;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">      case LED_2:                    // aktueller Zustand: LED 2 an</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        ledState = AUS;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        digitalWrite(pinLed1, LOW);</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        digitalWrite(pinLed2, LOW);</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        break;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        // Der Default-Fall wird nicht benötigt, da alle Wert abgefragt werden.</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="In die Zwischenablage kopieren" class="copyButton_Ue-o clean-btn">Kopieren</button></div></div><p>Automaten und Zustandsdiagramme sind besonders bei der Programmierung von <strong>Robotern</strong> sehr wichtig, da diese ein Vielzahl verschiedener Zustände einnehmen können.</p><details class="details_2Ziz alert alert--info details_1VDD ueben" data-collapsed="true"><summary>Aufgaben</summary><div><div class="collapsibleContent_3OHp"> <ol><li><p>Kopieren Sie des <a href="/docs/arduino/stateMachine#arduino-programmbeispiel">Beispielprogramm</a> und lassen sie es auf Ihrem Arduino mit der entsprechenden Schaltung laufen. Untersuchen Sie, was passiert, wenn einige der <code>break</code>-Anweisung auskommentiert (<code>// </code>) werden. Wie verhält sich dann Ihr Programm?</p></li><li><p>Zeichnen Sie ein Zustandsdiagramm für den Automaten mit <strong>zwei LEDs,</strong> bei dem folgende Übergänge bzw. Zustände erlaubt sind. Nach dem letzten Zustand springt der Automat in der ersten Zustand zurück.</p><p> alle Leds <strong>aus</strong> <span>→</span> Led <strong>1 an</strong>, Led 2 aus <span>→</span> alle Leds <strong>aus</strong> <span>→</span>  Led <strong>1&amp;2 an</strong> <span>→</span>  alle LEDs <strong>aus</strong> <span>→</span> Led <strong>2 an</strong>, Led 1 aus <span>→</span> . . .</p></li><li><p>Schreiben Sie ein Programm für den obigen Automaten und testen Sie es an einer entsprechenden Schaltung.</p></li><li><p>Ändern Sie das Programm für den ursprünglichen <a href="/docs/arduino/stateMachine#arduino-programmbeispiel">Automaten mit 2 LEDs</a> so, dass für jeden der vier Zustände ein eigenes Zeitintervall (<code>dTime1</code>, <code>dTime2</code>,...) angegeben werden kann, in welchem er aktiv ist. Oder anders ausgedrückt, jeder der vier Zustände soll unterschiedlich lange aktiv sein.</p></li><li><p>Programmieren Sie einen <strong>Reaktionstester</strong>. Bauen Sie dafür zuerst eine Schaltung <strong>mit zwei Tastern und zwei verschiedenfarbigen LEDs</strong> auf. Implementieren Sie folgendes Verhalten:</p><ol><li><p>Als Indikator, das der Test beginnen kann, leuchtet zu Beginn die <strong>LED 1</strong> und auf dem seriellen Monitor wird folgender Text ausgegeben:</p><div class="codeBlockContainer_K1bP language-text theme-code-block"><div class="codeBlockContent_hGly text"><pre tabindex="0" class="prism-code language-text codeBlock_23N8 thin-scrollbar" style="background-color:#282c34;color:#ffffff"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#ffffff"><span class="token plain">-------------------------------</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">Reaktionstester bereit!</span><br></span></code></pre><button type="button" aria-label="In die Zwischenablage kopieren" class="copyButton_Ue-o clean-btn">Kopieren</button></div></div></li><li><p>Anschließend wird der <strong>Taster S1</strong> gedrückt. Auf dem seriellen Monitor erscheint der Text:</p><div class="codeBlockContainer_K1bP language-text theme-code-block"><div class="codeBlockContent_hGly text"><pre tabindex="0" class="prism-code language-text codeBlock_23N8 thin-scrollbar" style="background-color:#282c34;color:#ffffff"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#ffffff"><span class="token plain">Warten auf das rote Licht ...</span><br></span></code></pre><button type="button" aria-label="In die Zwischenablage kopieren" class="copyButton_Ue-o clean-btn">Kopieren</button></div></div><p>Jetzt wird gewartet bis die <strong>LED 2</strong> aufleuchtet.</p></li><li><p>Nach einer <a href="https://www.arduino.cc/reference/de/language/functions/random-numbers/random/" target="_blank" rel="noopener noreferrer">zufälligen</a> Zeit leuchtet die <strong>LED 2</strong> auf und die <strong>LED 1</strong> fängt an schnell zu blinken. Von diesem Zeitpunkt wird die Zeit gemessen, bis der <strong>Taster 2</strong> betätigt wird.</p></li><li><p>Sobald der <strong>Taster 2</strong> gedrückt wurde, erlischt die <strong>LED 1</strong> und auf dem seriellen Monitor wird die Reaktionszeit in Sekunden angegeben:</p><div class="codeBlockContainer_K1bP language-text theme-code-block"><div class="codeBlockContent_hGly text"><pre tabindex="0" class="prism-code language-text codeBlock_23N8 thin-scrollbar" style="background-color:#282c34;color:#ffffff"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#ffffff"><span class="token plain">Reaktionszeit: 1,23 Sekunden</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">-------------------------------</span><br></span></code></pre><button type="button" aria-label="In die Zwischenablage kopieren" class="copyButton_Ue-o clean-btn">Kopieren</button></div></div></li></ol></li><li><p>Zeichnen Sie das Zustandsdiagramm für eine einfache Autoampel (mit den Bedingungen für die Zustandsübergänge). Für die Zeiten der einzelnen Ampelphasen gilt:</p><ul><li>ROT: 3 Sekunden</li><li>ROT-GELB: 0.5 Sekunden</li><li>GRÜN: 3 Sekunden</li><li>GELB: 1 Sekunde</li></ul><p>Bauen Sie anschließend eine geeignete Schaltung auf und programmieren Sie mit der <code>switch-case</code> Anweisung und dem <code>enum</code> Datentyp den endlichen Automaten für die Ampel.</p></li><li><p>Entwickeln Sie ein Programm und eine elektrische Schaltung zur Simulation  einer <strong>Ampelanlage für Fußgänger</strong> (eine Fußgängerampel <code>FA</code> und eine Ampel für PKWs <code>PA</code>). Ähnlich wie  bei <em>echten</em> Ampelanlagen für Fußgänger, darf die Fußgängerampel erst nach dem Betätigen eines Tasters (<em>Anforderung durch einen Fußgänger</em>) und einer gewissen Wartezeit auf Grün umschalten.  Beachten Sie bei der Bearbeitung der Aufgabe folgende Punkte:</p><ul><li>Erstellen Sie ein <strong>vollständiges Zustandsdiagramm</strong> für beide Ampeln. Recherchieren Sie die möglichen Zustände der Ampeln und benennen Sie diese sinnvoll (<code>FArot</code>, <code>FAgruen</code>, <code>PArot</code>, ...). Geben Sie im Zustandsdiagramm alle Zustände und Bedingungen für die Zustandsübergänge korrekt an.</li><li><strong>Entwickeln Sie eine Schaltung</strong> für die Ampelanlage. <strong>Zeichnen Sie Ihre Schaltung auf</strong> und bauen Sie sie anschließend auf dem Steckbrett auf. Vergessen Sie nicht den Taster für die Fußgängeranforderung.</li><li><strong>Schreiben Sie ein Programm</strong>, welches ihr Zustandsdiagramm umsetzt. Verwenden Sie die <code>switch-case</code>-Anweisung.</li></ul></li></ol></div></div></details></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"></div><div class="col lastUpdated_13-_"><span class="theme-last-updated">Letztes Update<!-- --> am <b><time datetime="2022-01-02T10:28:53.000Z">2.1.2022</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Dokumentation Seiten Navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/arduino/array"><div class="pagination-nav__sublabel">Zurück</div><div class="pagination-nav__label">9. Arrays (Listen)</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/arduino/pwm"><div class="pagination-nav__sublabel">Weiter</div><div class="pagination-nav__label">11. PWM Signal</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#wichtige-begriffe" class="table-of-contents__link toc-highlight">Wichtige Begriffe</a></li><li><a href="#zustandsdiagramm" class="table-of-contents__link toc-highlight">Zustandsdiagramm</a></li><li><a href="#programmiertechniken" class="table-of-contents__link toc-highlight">Programmiertechniken</a><ul><li><a href="#enum-aufzählungstyp" class="table-of-contents__link toc-highlight"><code>enum</code> Aufzählungstyp</a></li><li><a href="#switch-case-verzweigung" class="table-of-contents__link toc-highlight"><code>switch-case</code> Verzweigung</a></li><li><a href="#arduino-programmbeispiel" class="table-of-contents__link toc-highlight">Arduino-Programmbeispiel</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/SpaceHal/spacehal.github.io/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Forum<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Schule</div><ul class="footer__items"><li class="footer__item"><a href="https://www.osztiem.de/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>OSZTIEM<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://www.arduino.cc/reference/de/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Arduino<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a class="footer__link-item" href="/docs/impressum">Impressum</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Stefan Warm. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.b4fb05fd.js"></script>
<script src="/assets/js/main.42ef7b4b.js"></script>
</body>
</html>